{
    "CTI": {
        "text": "Microsoft Threat Intelligence has uncovered a supply chain attack by the North Korea-based threat actor Diamond Sleet (ZINC) involving a malicious variant of an application developed by CyberLink Corp., a software company that develops multimedia software products. This malicious file is a legitimate CyberLink application installer that has been modified to include malicious code that downloads, decrypts, and loads a second-stage payload. The file, which was signed using a valid certificate issued to CyberLink Corp., is hosted on legitimate update infrastructure owned by CyberLink and includes checks to limit the time window for execution and evade detection by security products. Thus far, the malicious activity has impacted over 100 devices in multiple countries, including Japan, Taiwan, Canada, and the United States.",
        "link": "https://www.microsoft.com/en-us/security/blog/2023/11/22/diamond-sleet-supply-chain-compromise-distributes-a-modified-cyberlink-installer/"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Microsoft Threat Intelligence",
                "relation": "has uncovered",
                "object": "a supply chain attack"
            },
            {
                "subject": "Diamond Sleet (ZINC)",
                "relation": "is",
                "object": "North Korea-based threat actor"
            },
            {
                "subject": "Diamond Sleet (ZINC)",
                "relation": "involving",
                "object": "a malicious variant of an application"
            },
            {
                "subject": "CyberLink Corp.",
                "relation": "develops",
                "object": "multimedia software products"
            },
            {
                "subject": "Malicious file",
                "relation": "is a",
                "object": "legitimate CyberLink application installer"
            },
            {
                "subject": "Malicious file",
                "relation": "modified to include",
                "object": "malicious code"
            },
            {
                "subject": "Malicious code",
                "relation": "downloads, decrypts, and loads",
                "object": "a second-stage payload"
            },
            {
                "subject": "Malicious file",
                "relation": "signed using",
                "object": "a valid certificate issued to CyberLink Corp."
            },
            {
                "subject": "Malicious file",
                "relation": "hosted on",
                "object": "legitimate update infrastructure owned by CyberLink"
            },
            {
                "subject": "Malicious activity",
                "relation": "impacted",
                "object": "over 100 devices"
            },
            {
                "subject": "Impacted devices",
                "relation": "located in",
                "object": "multiple countries"
            },
            {
                "subject": "Countries",
                "relation": "include",
                "object": "Japan"
            },
            {
                "subject": "Countries",
                "relation": "include",
                "object": "Taiwan"
            },
            {
                "subject": "Countries",
                "relation": "include",
                "object": "Canada"
            },
            {
                "subject": "Countries",
                "relation": "include",
                "object": "the United States"
            }
        ],
        "triples_count": 15,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1264,
                "cost": 0.01264
            },
            "output": {
                "tokens": 371,
                "cost": 0.011130000000000001
            },
            "total": {
                "tokens": 1635,
                "cost": 0.02377
            }
        },
        "time": 19.383728981018066,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/Eval/RQ2/DemoNum/2/prompt_store/Microsoft/diamond-sleet-QD1-3LQ.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 2,
            "demos": [
                [
                    "Microsoft: north-korean.json",
                    0.12356489440043357
                ],
                [
                    "Microsoft: teamcity-cve.json",
                    0.12371439124374012
                ]
            ],
            "permutation": "asc"
        },
        "Eval": {
            "metrics": {
                "tp": 12,
                "fp": 3,
                "fn": 2,
                "precision": 0.8,
                "recall": 0.8571428571428571,
                "f1": 0.8275862068965518
            },
            "matched_list": [
                [
                    [
                        "Microsoft Threat Intelligence",
                        "has uncovered",
                        "a supply chain attack"
                    ],
                    [
                        "Microsoft Threat Intelligence",
                        "has uncovered",
                        "a supply chain attack"
                    ]
                ],
                [
                    [
                        "Diamond Sleet (ZINC)",
                        "is",
                        "North Korea-based threat actor"
                    ],
                    [
                        "the threat actor Diamond Sleet (ZINC)",
                        "is based in",
                        "North Korea"
                    ]
                ],
                [
                    [
                        "Diamond Sleet (ZINC)",
                        "involving",
                        "a malicious variant of an application"
                    ],
                    [
                        "Diamond Sleet (ZINC)",
                        "involves in",
                        "a supply chain attack"
                    ]
                ],
                [
                    [
                        "CyberLink Corp.",
                        "develops",
                        "multimedia software products"
                    ],
                    [
                        "CyberLink Corp.",
                        "develops",
                        "multimedia software products"
                    ]
                ],
                [
                    [
                        "Malicious file",
                        "is a",
                        "legitimate CyberLink application installer"
                    ],
                    [
                        "the malicious file",
                        "is",
                        "a legitimate CyberLink application installer"
                    ]
                ],
                [
                    [
                        "Malicious file",
                        "modified to include",
                        "malicious code"
                    ],
                    [
                        "the malicious file",
                        "has been modified to",
                        "include malicious code"
                    ]
                ],
                [
                    [
                        "Malicious code",
                        "downloads, decrypts, and loads",
                        "a second-stage payload"
                    ],
                    [
                        "the malicious code",
                        "downloads, decrypts, and loads",
                        "a second-stage payload"
                    ]
                ],
                [
                    [
                        "Malicious file",
                        "signed using",
                        "a valid certificate issued to CyberLink Corp."
                    ],
                    [
                        "the file",
                        "is signed using",
                        "a valid certificate issued to CyberLink Corp."
                    ]
                ],
                [
                    [
                        "Malicious file",
                        "hosted on",
                        "legitimate update infrastructure owned by CyberLink"
                    ],
                    [
                        "the file",
                        "is hosted on",
                        "legitimate update infrastructure owned by CyberLink"
                    ]
                ],
                [
                    [
                        "Malicious activity",
                        "impacted",
                        "over 100 devices"
                    ],
                    [
                        "the malicious activity",
                        "has impacted",
                        "over 100 devices in multiple countries"
                    ]
                ],
                [
                    [
                        "Impacted devices",
                        "located in",
                        "multiple countries"
                    ],
                    [
                        "the malicious activity",
                        "has impacted",
                        "over 100 devices in multiple countries"
                    ]
                ],
                [
                    [
                        "Countries",
                        "include",
                        "Japan"
                    ],
                    [
                        "the countries impacted",
                        "include",
                        "Japan, Taiwan, Canada, and the United States"
                    ]
                ]
            ],
            "not_matched_list": [
                [
                    "Countries",
                    "include",
                    "Taiwan"
                ],
                [
                    "Countries",
                    "include",
                    "Canada"
                ],
                [
                    "Countries",
                    "include",
                    "the United States"
                ]
            ],
            "not_recall_list": [
                [
                    "the file",
                    "includes checks to",
                    "limit the time window for execution"
                ],
                [
                    "the file",
                    "evades",
                    "detection by security products"
                ]
            ]
        }
    }
}