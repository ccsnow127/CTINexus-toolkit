{
    "CTI": {
        "text": "More than 3,000 Internet-accessible Apache ActiveMQ Servers are exposed to a critical remote code execution vulnerability that an attacker has begun actively targeting to drop ransomware. The Apache Software Foundation (ASF) disclosed the vulnerability, tracked as CVE-2023-46604, on Oct. 27. The bug allows a remote attacker with access to an ActiveMQ message broker to execute arbitrary commands on affected systems. Proof-of-concept exploit code and full details of the vulnerability are publicly available, meaning that threat actors have both the means and the information to launch attacks against the vulnerability. Researchers at Rapid7 reported observing exploit activity targeting the flaw at two customer locations, starting the same day that ASF disclosed the threat. In both instances, the adversary attempted to deploy ransomware binaries on target systems in an effort to ransom the victim organizations. They described both targeted organizations as running outdated versions of Apache ActiveMQ. The researchers attributed the malicious activity to the HelloKitty ransomware family, based on the ransom note and other attack attributes. HelloKitty ransomware has been percolating in the wild since at least 2020. Its operators have tended to favor double-extortion attacks in which they have not just encrypted the data but also stolen it as additional leverage for extracting a ransom from victims. The HelloKitty ransomware attacks leveraging the ActiveMQ flaw appeared somewhat rudimentary. In one of the attacks, the threat actor made more than a half dozen attempts to encrypt the data, prompting the researchers to label to threat actor as 'clumsy' in their report.",
        "link": "https://www.darkreading.com/cyberattacks-data-breaches/attackers-target-max-severity-apache-activemq-bug-to-drop-ransomware"
    },
    "IE": {
        "triplets": [
            {
                "subject": "More than 3,000 Internet-accessible Apache ActiveMQ Servers",
                "relation": "are exposed to",
                "object": "a critical remote code execution vulnerability"
            },
            {
                "subject": "An attacker",
                "relation": "has begun actively targeting",
                "object": "to drop ransomware"
            },
            {
                "subject": "The Apache Software Foundation (ASF)",
                "relation": "disclosed",
                "object": "the vulnerability"
            },
            {
                "subject": "The vulnerability",
                "relation": "is tracked as",
                "object": "CVE-2023-46604"
            },
            {
                "subject": "The bug",
                "relation": "allows",
                "object": "a remote attacker with access to an ActiveMQ message broker to execute arbitrary commands on affected systems"
            },
            {
                "subject": "Researchers at Rapid7",
                "relation": "reported observing",
                "object": "exploit activity targeting the flaw"
            },
            {
                "subject": "The adversary",
                "relation": "attempted to deploy",
                "object": "ransomware binaries on target systems"
            },
            {
                "subject": "Targeted organizations",
                "relation": "are running",
                "object": "outdated versions of Apache ActiveMQ"
            },
            {
                "subject": "The malicious activity",
                "relation": "is attributed to",
                "object": "the HelloKitty ransomware family"
            },
            {
                "subject": "HelloKitty ransomware",
                "relation": "has been percolating",
                "object": "in the wild since at least 2020"
            },
            {
                "subject": "Its operators",
                "relation": "have tended to favor",
                "object": "double-extortion attacks"
            },
            {
                "subject": "The HelloKitty ransomware attacks",
                "relation": "leveraging",
                "object": "the ActiveMQ flaw"
            },
            {
                "subject": "The threat actor",
                "relation": "is labeled as",
                "object": "'clumsy'"
            }
        ],
        "triples_count": 13,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2063,
                "cost": 0.020630000000000003
            },
            "output": {
                "tokens": 472,
                "cost": 0.01416
            },
            "total": {
                "tokens": 2535,
                "cost": 0.03479
            }
        },
        "time": 23.226339101791382,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/Eval/RQ2/DemoNum/3/prompt_store/darkreading/apache-activemq-QD1-Exa.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "AVERTIUM: ragnar.json",
                    0.15153852451573424
                ],
                [
                    "darkreading: Apache-ERP.json",
                    0.17147263191323167
                ],
                [
                    "threatPost: Atlassian.json",
                    0.17207592732463362
                ]
            ],
            "permutation": "asc"
        },
        "Eval": {
            "metrics": {
                "tp": 9,
                "fp": 4,
                "fn": 8,
                "precision": 0.6923076923076923,
                "recall": 0.5294117647058824,
                "f1": 0.5999999999999999
            },
            "matched_list": [
                [
                    [
                        "More than 3,000 Internet-accessible Apache ActiveMQ Servers",
                        "are exposed to",
                        "a critical remote code execution vulnerability"
                    ],
                    [
                        "Internet-accessible Apache ActiveMQ Servers",
                        "are exposed to",
                        "a critical remote code execution vulnerability"
                    ],
                    [
                        0.7900070868387417,
                        1.0
                    ]
                ],
                [
                    [
                        "An attacker",
                        "has begun actively targeting",
                        "to drop ransomware"
                    ],
                    [
                        "An attacker",
                        "has begun actively targeting",
                        "to drop ransomware"
                    ],
                    [
                        1.0,
                        1.0
                    ]
                ],
                [
                    [
                        "The Apache Software Foundation (ASF)",
                        "disclosed",
                        "the vulnerability"
                    ],
                    [
                        "The Apache Software Foundation",
                        "disclosed",
                        "CVE-2023-46604"
                    ],
                    [
                        0.9413480621496385,
                        0.4942616101516961
                    ]
                ],
                [
                    [
                        "The vulnerability",
                        "is tracked as",
                        "CVE-2023-46604"
                    ],
                    [
                        "CVE-2023-46604",
                        "allows",
                        "a remote attacker with access to execute arbitrary commands"
                    ],
                    [
                        0.529807348791341,
                        0.45706653479592796
                    ]
                ],
                [
                    [
                        "Researchers at Rapid7",
                        "reported observing",
                        "exploit activity targeting the flaw"
                    ],
                    [
                        "Researchers at Rapid7",
                        "reported observing exploit activity",
                        "targeting the flaw"
                    ],
                    [
                        1.0,
                        0.7061069999436642
                    ]
                ],
                [
                    [
                        "The adversary",
                        "attempted to deploy",
                        "ransomware binaries on target systems"
                    ],
                    [
                        "An attacker",
                        "has begun actively targeting",
                        "to drop ransomware"
                    ],
                    [
                        0.5984748164491632,
                        0.6325297357513281
                    ]
                ],
                [
                    [
                        "Targeted organizations",
                        "are running",
                        "outdated versions of Apache ActiveMQ"
                    ],
                    [
                        "Targeted organizations",
                        "were running",
                        "outdated versions of Apache ActiveMQ"
                    ],
                    [
                        1.0,
                        1.0
                    ]
                ],
                [
                    [
                        "The malicious activity",
                        "is attributed to",
                        "the HelloKitty ransomware family"
                    ],
                    [
                        "An attacker",
                        "has begun actively targeting",
                        "to drop ransomware"
                    ],
                    [
                        0.48143581295899096,
                        0.547428799544785
                    ]
                ],
                [
                    [
                        "HelloKitty ransomware",
                        "has been percolating",
                        "in the wild since at least 2020"
                    ],
                    [
                        "HelloKitty ransomware",
                        "has been percolating in the wild since",
                        "at least 2020"
                    ],
                    [
                        1.0,
                        0.6196207697980564
                    ]
                ]
            ],
            "not_matched_list": [
                [
                    "The bug",
                    "allows",
                    "a remote attacker with access to an ActiveMQ message broker to execute arbitrary commands on affected systems"
                ],
                [
                    "Its operators",
                    "have tended to favor",
                    "double-extortion attacks"
                ],
                [
                    "The HelloKitty ransomware attacks",
                    "leveraging",
                    "the ActiveMQ flaw"
                ],
                [
                    "The threat actor",
                    "is labeled as",
                    "'clumsy'"
                ]
            ],
            "not_recall_list": [
                [
                    "Threat actors",
                    "have",
                    "the means and the information to launch attacks"
                ],
                [
                    "The adversary",
                    "attempted to deploy",
                    "ransomware binaries"
                ],
                [
                    "The malicious activity",
                    "is attributed to",
                    "the HelloKitty ransomware family"
                ],
                [
                    "HelloKitty ransomware",
                    "favors",
                    "double-extortion attacks"
                ],
                [
                    "Double-extortion attacks",
                    "involve",
                    "encrypting the data"
                ],
                [
                    "Double-extortion attacks",
                    "involve",
                    "stealing the data"
                ],
                [
                    "The threat actor",
                    "made attempts",
                    "to encrypt the data"
                ],
                [
                    "Researchers",
                    "label the threat actor as",
                    "'clumsy'"
                ]
            ]
        }
    }
}