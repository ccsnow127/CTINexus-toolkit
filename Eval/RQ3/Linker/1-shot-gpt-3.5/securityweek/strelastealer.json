{
    "CTI": {
        "text": "Over 100 organizations in the US and EU have been targeted in recent large-scale phishing campaigns distributing the information stealer malware known as StrelaStealer, Palo Alto Networks reports. First documented in November 2022, StrelaStealer harvests credentials from the well-known email clients and sends them to an attacker-controlled command-and-control (C&C) server specified in the malware\u2019s configuration. Over the past five months, Palo Alto Networks identified multiple large-scale campaigns carrying attachments deploying the infostealer in the form of a malicious DLL.Following an initial wave of emails in November 2023, the attackers launched two more in January and February 2024, mostly targeting the same North American and European regions. Tailored to local languages, the spam messages were mainly sent to organizations in the high-tech sector, with entities across finance, professional and legal services, manufacturing, government, utilities and energy, insurance, and construction targeted as well. Unlike earlier StrelaStealer campaigns that featured ISO attachments containing LNK and HTML files designed to fetch the malware from a remote server, the recent attacks involved a ZIP attachment that contained a JScript file designed to drop the final payload in the form of a DLL.",
        "link": "https://www.securityweek.com/over-100-organizations-targeted-in-recent-strelastealer-attacks/"
    },
    "IE": {
        "triplets": [
            {
                "subject": "StrelaStealer",
                "relation": "targets",
                "object": "organizations in the US and EU"
            },
            {
                "subject": "StrelaStealer",
                "relation": "is",
                "object": "information stealer malware"
            },
            {
                "subject": "StrelaStealer",
                "relation": "harvests",
                "object": "credentials"
            },
            {
                "subject": "StrelaStealer",
                "relation": "sends credentials to",
                "object": "attacker-controlled C&C server"
            },
            {
                "subject": "Palo Alto Networks",
                "relation": "identified",
                "object": "campaigns distributing StrelaStealer"
            },
            {
                "subject": "Campaigns",
                "relation": "deploy",
                "object": "StrelaStealer via malicious DLL"
            },
            {
                "subject": "Campaigns",
                "relation": "target",
                "object": "the high-tech sector"
            },
            {
                "subject": "Campaigns",
                "relation": "target",
                "object": "finance sector"
            },
            {
                "subject": "Campaigns",
                "relation": "target",
                "object": "professional and legal services sector"
            },
            {
                "subject": "Campaigns",
                "relation": "target",
                "object": "manufacturing sector"
            },
            {
                "subject": "Campaigns",
                "relation": "target",
                "object": "government sector"
            },
            {
                "subject": "Campaigns",
                "relation": "target",
                "object": "utilities and energy sector"
            },
            {
                "subject": "Campaigns",
                "relation": "target",
                "object": "insurance sector"
            },
            {
                "subject": "Campaigns",
                "relation": "target",
                "object": "construction sector"
            },
            {
                "subject": "Earlier StrelaStealer campaigns",
                "relation": "featured",
                "object": "ISO attachments"
            },
            {
                "subject": "Recent attacks",
                "relation": "involved",
                "object": "ZIP attachment containing a JScript file"
            },
            {
                "subject": "JScript file",
                "relation": "designed to drop",
                "object": "the final payload in the form of a DLL"
            }
        ],
        "triples_count": 17,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 3593,
                "cost": 0.035930000000000004
            },
            "output": {
                "tokens": 437,
                "cost": 0.01311
            },
            "total": {
                "tokens": 4030,
                "cost": 0.04904
            }
        },
        "time": 10.11401891708374,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/securityweek/strelastealer-QD1-Nsd.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "AVERTIUM-mallox.json",
                    0.0841223799673041
                ],
                [
                    "AVERTIUM-muddywater.json",
                    0.09140822119202556
                ],
                [
                    "AVERTIUM-fancy-bear.json",
                    0.09525826024451005
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "StrelaStealer",
                    "class": "Malware"
                },
                "relation": "targets",
                "object": {
                    "text": "organizations in the US and EU",
                    "class": "Location"
                }
            },
            {
                "subject": {
                    "text": "StrelaStealer",
                    "class": "Malware"
                },
                "relation": "is",
                "object": {
                    "text": "information stealer malware",
                    "class": "Malware Characteristic:Behavior"
                }
            },
            {
                "subject": {
                    "text": "StrelaStealer",
                    "class": "Malware"
                },
                "relation": "harvests",
                "object": {
                    "text": "credentials",
                    "class": "Credential"
                }
            },
            {
                "subject": {
                    "text": "StrelaStealer",
                    "class": "Malware"
                },
                "relation": "sends credentials to",
                "object": {
                    "text": "attacker-controlled C&C server",
                    "class": "Infrastructure"
                }
            },
            {
                "subject": {
                    "text": "Palo Alto Networks",
                    "class": "Organization"
                },
                "relation": "identified",
                "object": {
                    "text": "campaigns distributing StrelaStealer",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "deploy",
                "object": {
                    "text": "StrelaStealer via malicious DLL",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "the high-tech sector",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "finance sector",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "professional and legal services sector",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "manufacturing sector",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "government sector",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "utilities and energy sector",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "insurance sector",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Campaigns",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "construction sector",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Earlier StrelaStealer campaigns",
                    "class": "Event"
                },
                "relation": "featured",
                "object": {
                    "text": "ISO attachments",
                    "class": "Indicator:File"
                }
            },
            {
                "subject": {
                    "text": "Recent attacks",
                    "class": "Event"
                },
                "relation": "involved",
                "object": {
                    "text": "ZIP attachment containing a JScript file",
                    "class": "Indicator:File"
                }
            },
            {
                "subject": {
                    "text": "JScript file",
                    "class": "Indicator:File"
                },
                "relation": "designed to drop",
                "object": {
                    "text": "the final payload in the form of a DLL",
                    "class": "Malware"
                }
            }
        ],
        "response_time": 34.664470195770264,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/securityweek/strelastealer.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1670,
                "cost": 0.016700000000000003
            },
            "output": {
                "tokens": 864,
                "cost": 0.025920000000000002
            },
            "total": {
                "tokens": 2534,
                "cost": 0.042620000000000005
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "StrelaStealer",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer via malicious DLL"
                    ],
                    "entity_text": "StrelaStealer"
                },
                "relation": "targets",
                "object": {
                    "mention_id": 1,
                    "mention_text": "organizations in the US and EU",
                    "mention_class": "Location",
                    "entity_id": 2,
                    "mentions_merged": [
                        "organizations in the US and EU"
                    ],
                    "entity_text": "organizations in the US and EU"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "StrelaStealer",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer via malicious DLL"
                    ],
                    "entity_text": "StrelaStealer"
                },
                "relation": "is",
                "object": {
                    "mention_id": 3,
                    "mention_text": "information stealer malware",
                    "mention_class": "Malware Characteristic:Behavior",
                    "entity_id": 3,
                    "mentions_merged": [
                        "information stealer malware"
                    ],
                    "entity_text": "information stealer malware"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "StrelaStealer",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer via malicious DLL"
                    ],
                    "entity_text": "StrelaStealer"
                },
                "relation": "harvests",
                "object": {
                    "mention_id": 5,
                    "mention_text": "credentials",
                    "mention_class": "Credential",
                    "entity_id": 4,
                    "mentions_merged": [
                        "credentials"
                    ],
                    "entity_text": "credentials"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "StrelaStealer",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer via malicious DLL"
                    ],
                    "entity_text": "StrelaStealer"
                },
                "relation": "sends credentials to",
                "object": {
                    "mention_id": 7,
                    "mention_text": "attacker-controlled C&C server",
                    "mention_class": "Infrastructure",
                    "entity_id": 5,
                    "mentions_merged": [
                        "attacker-controlled C&C server"
                    ],
                    "entity_text": "attacker-controlled C&C server"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "Palo Alto Networks",
                    "mention_class": "Organization",
                    "entity_id": 6,
                    "mentions_merged": [
                        "Palo Alto Networks"
                    ],
                    "entity_text": "Palo Alto Networks"
                },
                "relation": "identified",
                "object": {
                    "mention_id": 9,
                    "mention_text": "campaigns distributing StrelaStealer",
                    "mention_class": "Event",
                    "entity_id": 7,
                    "mentions_merged": [
                        "campaigns distributing StrelaStealer",
                        "Earlier StrelaStealer campaigns"
                    ],
                    "entity_text": "Earlier StrelaStealer campaigns"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "deploy",
                "object": {
                    "mention_id": 11,
                    "mention_text": "StrelaStealer via malicious DLL",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer",
                        "StrelaStealer via malicious DLL"
                    ],
                    "entity_text": "StrelaStealer"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "target",
                "object": {
                    "mention_id": 13,
                    "mention_text": "the high-tech sector",
                    "mention_class": "Information",
                    "entity_id": 11,
                    "mentions_merged": [
                        "the high-tech sector"
                    ],
                    "entity_text": "the high-tech sector"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "target",
                "object": {
                    "mention_id": 15,
                    "mention_text": "finance sector",
                    "mention_class": "Information",
                    "entity_id": 10,
                    "mentions_merged": [
                        "finance sector",
                        "manufacturing sector",
                        "government sector",
                        "insurance sector",
                        "construction sector"
                    ],
                    "entity_text": "finance sector"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "target",
                "object": {
                    "mention_id": 17,
                    "mention_text": "professional and legal services sector",
                    "mention_class": "Information",
                    "entity_id": 12,
                    "mentions_merged": [
                        "professional and legal services sector"
                    ],
                    "entity_text": "professional and legal services sector"
                }
            },
            {
                "subject": {
                    "mention_id": 18,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "target",
                "object": {
                    "mention_id": 19,
                    "mention_text": "manufacturing sector",
                    "mention_class": "Information",
                    "entity_id": 10,
                    "mentions_merged": [
                        "finance sector",
                        "manufacturing sector",
                        "government sector",
                        "insurance sector",
                        "construction sector"
                    ],
                    "entity_text": "finance sector"
                }
            },
            {
                "subject": {
                    "mention_id": 20,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "target",
                "object": {
                    "mention_id": 21,
                    "mention_text": "government sector",
                    "mention_class": "Information",
                    "entity_id": 10,
                    "mentions_merged": [
                        "finance sector",
                        "manufacturing sector",
                        "government sector",
                        "insurance sector",
                        "construction sector"
                    ],
                    "entity_text": "finance sector"
                }
            },
            {
                "subject": {
                    "mention_id": 22,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "target",
                "object": {
                    "mention_id": 23,
                    "mention_text": "utilities and energy sector",
                    "mention_class": "Information",
                    "entity_id": 13,
                    "mentions_merged": [
                        "utilities and energy sector"
                    ],
                    "entity_text": "utilities and energy sector"
                }
            },
            {
                "subject": {
                    "mention_id": 24,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "target",
                "object": {
                    "mention_id": 25,
                    "mention_text": "insurance sector",
                    "mention_class": "Information",
                    "entity_id": 10,
                    "mentions_merged": [
                        "finance sector",
                        "manufacturing sector",
                        "government sector",
                        "insurance sector",
                        "construction sector"
                    ],
                    "entity_text": "finance sector"
                }
            },
            {
                "subject": {
                    "mention_id": 26,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "target",
                "object": {
                    "mention_id": 27,
                    "mention_text": "construction sector",
                    "mention_class": "Information",
                    "entity_id": 10,
                    "mentions_merged": [
                        "finance sector",
                        "manufacturing sector",
                        "government sector",
                        "insurance sector",
                        "construction sector"
                    ],
                    "entity_text": "finance sector"
                }
            },
            {
                "subject": {
                    "mention_id": 28,
                    "mention_text": "Earlier StrelaStealer campaigns",
                    "mention_class": "Event",
                    "entity_id": 7,
                    "mentions_merged": [
                        "campaigns distributing StrelaStealer",
                        "Earlier StrelaStealer campaigns"
                    ],
                    "entity_text": "Earlier StrelaStealer campaigns"
                },
                "relation": "featured",
                "object": {
                    "mention_id": 29,
                    "mention_text": "ISO attachments",
                    "mention_class": "Indicator:File",
                    "entity_id": 15,
                    "mentions_merged": [
                        "ISO attachments"
                    ],
                    "entity_text": "ISO attachments"
                }
            },
            {
                "subject": {
                    "mention_id": 30,
                    "mention_text": "Recent attacks",
                    "mention_class": "Event",
                    "entity_id": 9,
                    "mentions_merged": [
                        "Recent attacks"
                    ],
                    "entity_text": "Recent attacks"
                },
                "relation": "involved",
                "object": {
                    "mention_id": 31,
                    "mention_text": "ZIP attachment containing a JScript file",
                    "mention_class": "Indicator:File",
                    "entity_id": 14,
                    "mentions_merged": [
                        "JScript file",
                        "ZIP attachment containing a JScript file"
                    ],
                    "entity_text": "JScript file"
                }
            },
            {
                "subject": {
                    "mention_id": 32,
                    "mention_text": "JScript file",
                    "mention_class": "Indicator:File",
                    "entity_id": 14,
                    "mentions_merged": [
                        "JScript file",
                        "ZIP attachment containing a JScript file"
                    ],
                    "entity_text": "JScript file"
                },
                "relation": "designed to drop",
                "object": {
                    "mention_id": 33,
                    "mention_text": "the final payload in the form of a DLL",
                    "mention_class": "Malware",
                    "entity_id": 1,
                    "mentions_merged": [
                        "the final payload in the form of a DLL"
                    ],
                    "entity_text": "the final payload in the form of a DLL"
                }
            }
        ],
        "mentions_num": 34,
        "response_time": 7.5563063621521,
        "embedding_model": "text-embedding-3-large",
        "entity_num": 16
    },
    "LP": {
        "predicted_links": [
            {
                "subject": {
                    "entity_id": 7,
                    "mention_text": "Earlier StrelaStealer campaigns"
                },
                "relation": "featured",
                "object": {
                    "mention_id": 10,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "Campaigns",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns",
                        "Campaigns"
                    ],
                    "entity_text": "Campaigns"
                },
                "relation": "involved",
                "object": {
                    "entity_id": 14,
                    "mention_text": "JScript file"
                }
            }
        ],
        "response_time": 2.127272844314575,
        "model": "gpt-3.5-turbo-0125",
        "usage": {
            "input": {
                "tokens": 1060,
                "cost": 0.00053
            },
            "output": {
                "tokens": 69,
                "cost": 0.0001035
            },
            "total": {
                "tokens": 1129,
                "cost": 0.0006335
            }
        },
        "topic_node": {
            "mention_id": 10,
            "mention_text": "Campaigns",
            "mention_class": "Event",
            "entity_id": 8,
            "mentions_merged": [
                "Campaigns",
                "Campaigns",
                "Campaigns",
                "Campaigns",
                "Campaigns",
                "Campaigns",
                "Campaigns",
                "Campaigns",
                "Campaigns"
            ],
            "entity_text": "Campaigns"
        },
        "main_nodes": [
            {
                "mention_id": 9,
                "mention_text": "campaigns distributing StrelaStealer",
                "mention_class": "Event",
                "entity_id": 7,
                "mentions_merged": [
                    "campaigns distributing StrelaStealer",
                    "Earlier StrelaStealer campaigns"
                ],
                "entity_text": "Earlier StrelaStealer campaigns"
            },
            {
                "mention_id": 31,
                "mention_text": "ZIP attachment containing a JScript file",
                "mention_class": "Indicator:File",
                "entity_id": 14,
                "mentions_merged": [
                    "JScript file",
                    "ZIP attachment containing a JScript file"
                ],
                "entity_text": "JScript file"
            }
        ],
        "subgraphs": [
            [
                0,
                2,
                3,
                4,
                5,
                8,
                10,
                11,
                12,
                13
            ],
            [
                15,
                6,
                7
            ],
            [
                9,
                14,
                1
            ]
        ],
        "subgraph_num": 3,
        "Eval": {
            "correct": 0,
            "incorrect": 2
        }
    }
}