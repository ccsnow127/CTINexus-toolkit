{
    "CTI": {
        "text": "Since early October 2023, Microsoft has observed two North Korean nation-state threat actors \u2013 Diamond Sleet and Onyx Sleet \u2013 exploiting CVE-2023-42793, a remote-code execution vulnerability affecting multiple versions of JetBrains TeamCity server. TeamCity is a continuous integration/continuous deployment (CI/CD) application used by organizations for DevOps and other software development activities.",
        "link": "https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Microsoft",
                "relation": "has observed",
                "object": "two North Korean nation-state threat actors"
            },
            {
                "subject": "two North Korean nation-state threat actors",
                "relation": "include",
                "object": "Diamond Sleet"
            },
            {
                "subject": "two North Korean nation-state threat actors",
                "relation": "include",
                "object": "Onyx Sleet"
            },
            {
                "subject": "Diamond Sleet",
                "relation": "exploiting",
                "object": "CVE-2023-42793"
            },
            {
                "subject": "Onyx Sleet",
                "relation": "exploiting",
                "object": "CVE-2023-42793"
            },
            {
                "subject": "CVE-2023-42793",
                "relation": "is a",
                "object": "remote-code execution vulnerability"
            },
            {
                "subject": "CVE-2023-42793",
                "relation": "affects",
                "object": "multiple versions of JetBrains TeamCity server"
            },
            {
                "subject": "TeamCity",
                "relation": "is a",
                "object": "continuous integration/continuous deployment (CI/CD) application"
            },
            {
                "subject": "TeamCity",
                "relation": "used by",
                "object": "organizations for DevOps and other software development activities"
            }
        ],
        "triples_count": 9,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2000,
                "cost": 0.02
            },
            "output": {
                "tokens": 258,
                "cost": 0.00774
            },
            "total": {
                "tokens": 2258,
                "cost": 0.02774
            }
        },
        "time": 7.434916257858276,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/Microsoft/teamcity-cve-QD1-cN6.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-atlassian.json",
                    0.06809823445854325
                ],
                [
                    "AVERTIUM-CVE-2023-36884.json",
                    0.08600185287622127
                ],
                [
                    "BleepingComputer-androxgh0st.json",
                    0.09229553425561586
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "Microsoft",
                    "class": "Organization"
                },
                "relation": "has observed",
                "object": {
                    "text": "two North Korean nation-state threat actors",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "two North Korean nation-state threat actors",
                    "class": "Attacker"
                },
                "relation": "include",
                "object": {
                    "text": "Diamond Sleet",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "two North Korean nation-state threat actors",
                    "class": "Attacker"
                },
                "relation": "include",
                "object": {
                    "text": "Onyx Sleet",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "Diamond Sleet",
                    "class": "Attacker"
                },
                "relation": "exploiting",
                "object": {
                    "text": "CVE-2023-42793",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "Onyx Sleet",
                    "class": "Attacker"
                },
                "relation": "exploiting",
                "object": {
                    "text": "CVE-2023-42793",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "CVE-2023-42793",
                    "class": "Vulnerability"
                },
                "relation": "is a",
                "object": {
                    "text": "remote-code execution vulnerability",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "CVE-2023-42793",
                    "class": "Vulnerability"
                },
                "relation": "affects",
                "object": {
                    "text": "multiple versions of JetBrains TeamCity server",
                    "class": "Infrastructure"
                }
            },
            {
                "subject": {
                    "text": "TeamCity",
                    "class": "Tool"
                },
                "relation": "is a",
                "object": {
                    "text": "continuous integration/continuous deployment (CI/CD) application",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "TeamCity",
                    "class": "Tool"
                },
                "relation": "used by",
                "object": {
                    "text": "organizations for DevOps and other software development activities",
                    "class": "Information"
                }
            }
        ],
        "response_time": 25.70150899887085,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/Microsoft/teamcity-cve.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1358,
                "cost": 0.013580000000000002
            },
            "output": {
                "tokens": 504,
                "cost": 0.01512
            },
            "total": {
                "tokens": 1862,
                "cost": 0.028700000000000003
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "Microsoft",
                    "mention_class": "Organization",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Microsoft"
                    ],
                    "entity_text": "Microsoft"
                },
                "relation": "has observed",
                "object": {
                    "mention_id": 1,
                    "mention_text": "two North Korean nation-state threat actors",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "two North Korean nation-state threat actors",
                        "two North Korean nation-state threat actors",
                        "two North Korean nation-state threat actors"
                    ],
                    "entity_text": "two North Korean nation-state threat actors"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "two North Korean nation-state threat actors",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "two North Korean nation-state threat actors",
                        "two North Korean nation-state threat actors",
                        "two North Korean nation-state threat actors"
                    ],
                    "entity_text": "two North Korean nation-state threat actors"
                },
                "relation": "include",
                "object": {
                    "mention_id": 3,
                    "mention_text": "Diamond Sleet",
                    "mention_class": "Attacker",
                    "entity_id": 2,
                    "mentions_merged": [
                        "Onyx Sleet",
                        "Diamond Sleet",
                        "Onyx Sleet",
                        "Diamond Sleet"
                    ],
                    "entity_text": "Onyx Sleet"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "two North Korean nation-state threat actors",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "two North Korean nation-state threat actors",
                        "two North Korean nation-state threat actors",
                        "two North Korean nation-state threat actors"
                    ],
                    "entity_text": "two North Korean nation-state threat actors"
                },
                "relation": "include",
                "object": {
                    "mention_id": 5,
                    "mention_text": "Onyx Sleet",
                    "mention_class": "Attacker",
                    "entity_id": 2,
                    "mentions_merged": [
                        "Onyx Sleet",
                        "Diamond Sleet",
                        "Onyx Sleet",
                        "Diamond Sleet"
                    ],
                    "entity_text": "Onyx Sleet"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "Diamond Sleet",
                    "mention_class": "Attacker",
                    "entity_id": 2,
                    "mentions_merged": [
                        "Onyx Sleet",
                        "Diamond Sleet",
                        "Onyx Sleet",
                        "Diamond Sleet"
                    ],
                    "entity_text": "Onyx Sleet"
                },
                "relation": "exploiting",
                "object": {
                    "mention_id": 7,
                    "mention_text": "CVE-2023-42793",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "CVE-2023-42793",
                        "CVE-2023-42793",
                        "CVE-2023-42793",
                        "CVE-2023-42793"
                    ],
                    "entity_text": "CVE-2023-42793"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "Onyx Sleet",
                    "mention_class": "Attacker",
                    "entity_id": 2,
                    "mentions_merged": [
                        "Onyx Sleet",
                        "Diamond Sleet",
                        "Onyx Sleet",
                        "Diamond Sleet"
                    ],
                    "entity_text": "Onyx Sleet"
                },
                "relation": "exploiting",
                "object": {
                    "mention_id": 9,
                    "mention_text": "CVE-2023-42793",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "CVE-2023-42793",
                        "CVE-2023-42793",
                        "CVE-2023-42793",
                        "CVE-2023-42793"
                    ],
                    "entity_text": "CVE-2023-42793"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "CVE-2023-42793",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "CVE-2023-42793",
                        "CVE-2023-42793",
                        "CVE-2023-42793",
                        "CVE-2023-42793"
                    ],
                    "entity_text": "CVE-2023-42793"
                },
                "relation": "is a",
                "object": {
                    "mention_id": 11,
                    "mention_text": "remote-code execution vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 4,
                    "mentions_merged": [
                        "remote-code execution vulnerability"
                    ],
                    "entity_text": "remote-code execution vulnerability"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "CVE-2023-42793",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "CVE-2023-42793",
                        "CVE-2023-42793",
                        "CVE-2023-42793",
                        "CVE-2023-42793"
                    ],
                    "entity_text": "CVE-2023-42793"
                },
                "relation": "affects",
                "object": {
                    "mention_id": 13,
                    "mention_text": "multiple versions of JetBrains TeamCity server",
                    "mention_class": "Infrastructure",
                    "entity_id": 5,
                    "mentions_merged": [
                        "multiple versions of JetBrains TeamCity server"
                    ],
                    "entity_text": "multiple versions of JetBrains TeamCity server"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "TeamCity",
                    "mention_class": "Tool",
                    "entity_id": 6,
                    "mentions_merged": [
                        "TeamCity",
                        "TeamCity"
                    ],
                    "entity_text": "TeamCity"
                },
                "relation": "is a",
                "object": {
                    "mention_id": 15,
                    "mention_text": "continuous integration/continuous deployment (CI/CD) application",
                    "mention_class": "Tool",
                    "entity_id": 7,
                    "mentions_merged": [
                        "continuous integration/continuous deployment (CI/CD) application"
                    ],
                    "entity_text": "continuous integration/continuous deployment (CI/CD) application"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "TeamCity",
                    "mention_class": "Tool",
                    "entity_id": 6,
                    "mentions_merged": [
                        "TeamCity",
                        "TeamCity"
                    ],
                    "entity_text": "TeamCity"
                },
                "relation": "used by",
                "object": {
                    "mention_id": 17,
                    "mention_text": "organizations for DevOps and other software development activities",
                    "mention_class": "Information",
                    "entity_id": 8,
                    "mentions_merged": [
                        "organizations for DevOps and other software development activities"
                    ],
                    "entity_text": "organizations for DevOps and other software development activities"
                }
            }
        ],
        "mentions_num": 18,
        "response_time": 3.6262073516845703,
        "embedding_model": "text-embedding-3-large",
        "entity_num": 9
    },
    "LP": {
        "predicted_links": [
            {
                "subject": {
                    "entity_id": 6,
                    "mention_text": "TeamCity"
                },
                "relation": "affected by",
                "object": {
                    "mention_id": 3,
                    "mention_text": "Diamond Sleet",
                    "mention_class": "Attacker",
                    "entity_id": 2,
                    "mentions_merged": [
                        "Onyx Sleet",
                        "Diamond Sleet",
                        "Onyx Sleet",
                        "Diamond Sleet"
                    ],
                    "entity_text": "Onyx Sleet"
                }
            }
        ],
        "response_time": 2.166688919067383,
        "model": "gpt-3.5-turbo-0125",
        "usage": {
            "input": {
                "tokens": 360,
                "cost": 0.00017999999999999998
            },
            "output": {
                "tokens": 31,
                "cost": 4.65e-05
            },
            "total": {
                "tokens": 391,
                "cost": 0.00022649999999999998
            }
        },
        "topic_node": {
            "mention_id": 3,
            "mention_text": "Diamond Sleet",
            "mention_class": "Attacker",
            "entity_id": 2,
            "mentions_merged": [
                "Onyx Sleet",
                "Diamond Sleet",
                "Onyx Sleet",
                "Diamond Sleet"
            ],
            "entity_text": "Onyx Sleet"
        },
        "main_nodes": [
            {
                "mention_id": 14,
                "mention_text": "TeamCity",
                "mention_class": "Tool",
                "entity_id": 6,
                "mentions_merged": [
                    "TeamCity",
                    "TeamCity"
                ],
                "entity_text": "TeamCity"
            }
        ],
        "subgraphs": [
            [
                0,
                1,
                2,
                3,
                4,
                5
            ],
            [
                8,
                6,
                7
            ]
        ],
        "subgraph_num": 2,
        "Eval": {
            "correct": 1,
            "incorrect": 0
        }
    }
}