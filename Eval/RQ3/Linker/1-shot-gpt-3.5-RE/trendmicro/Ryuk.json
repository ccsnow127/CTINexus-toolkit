{
    "CTI": {
        "text": "Starting this year, Ryuk began using another dropper called BazarLoader (also known as BazarBackdoor). Like Trickbot, BazarLoader is also primarily distributed via phishing emails that contain either malicious attachments or links to websites (typically free, online file-hosting solutions) that host malware. These phishing emails use normal social engineering techniques: For example, they are usually disguised as business correspondence or other important messages. Once the payload is distributed, a command-and-control (C&C) server is used to deploy and install the backdoor. According to the advisory, the threat actor behind TrickBot is also connected to BazarLoader.",
        "link": "https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ryuk-2020-distributing-ransomware-via-trickbot-and-bazarloader"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Ryuk",
                "relation": "began using",
                "object": "BazarLoader"
            },
            {
                "subject": "BazarLoader",
                "relation": "is known as",
                "object": "BazarBackdoor"
            },
            {
                "subject": "BazarLoader",
                "relation": "is primarily distributed via",
                "object": "phishing emails"
            },
            {
                "subject": "phishing emails",
                "relation": "contain",
                "object": "malicious attachments"
            },
            {
                "subject": "phishing emails",
                "relation": "contain",
                "object": "links to websites"
            },
            {
                "subject": "websites",
                "relation": "host",
                "object": "malware"
            },
            {
                "subject": "phishing emails",
                "relation": "use",
                "object": "social engineering techniques"
            },
            {
                "subject": "phishing emails",
                "relation": "disguised as",
                "object": "business correspondence"
            },
            {
                "subject": "payload",
                "relation": "is distributed, a command-and-control (C&C) server is used to",
                "object": "deploy and install the backdoor"
            },
            {
                "subject": "Trickbot",
                "relation": "connected to",
                "object": "BazarLoader"
            }
        ],
        "triples_count": 10,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2772,
                "cost": 0.02772
            },
            "output": {
                "tokens": 252,
                "cost": 0.00756
            },
            "total": {
                "tokens": 3024,
                "cost": 0.03528
            }
        },
        "time": 7.232931137084961,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/trendmicro/Ryuk-QD1-Y2c.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-purplefox.json",
                    0.08719161099727128
                ],
                [
                    "AVERTIUM-charming-kitten.json",
                    0.09142067730844404
                ],
                [
                    "AVERTIUM-mallox.json",
                    0.09425733057019965
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "Ryuk",
                    "class": "Malware"
                },
                "relation": "began using",
                "object": {
                    "text": "BazarLoader",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "BazarLoader",
                    "class": "Malware"
                },
                "relation": "is known as",
                "object": {
                    "text": "BazarBackdoor",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "BazarLoader",
                    "class": "Malware"
                },
                "relation": "is primarily distributed via",
                "object": {
                    "text": "phishing emails",
                    "class": "Indicator:Email"
                }
            },
            {
                "subject": {
                    "text": "phishing emails",
                    "class": "Indicator:Email"
                },
                "relation": "contain",
                "object": {
                    "text": "malicious attachments",
                    "class": "Malware Characteristic:Payload"
                }
            },
            {
                "subject": {
                    "text": "phishing emails",
                    "class": "Indicator:Email"
                },
                "relation": "contain",
                "object": {
                    "text": "links to websites",
                    "class": "Indicator:URL"
                }
            },
            {
                "subject": {
                    "text": "websites",
                    "class": "Indicator:URL"
                },
                "relation": "host",
                "object": {
                    "text": "malware",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "phishing emails",
                    "class": "Indicator:Email"
                },
                "relation": "use",
                "object": {
                    "text": "social engineering techniques",
                    "class": "Malware Characteristic:Behavior"
                }
            },
            {
                "subject": {
                    "text": "phishing emails",
                    "class": "Indicator:Email"
                },
                "relation": "disguised as",
                "object": {
                    "text": "business correspondence",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "payload",
                    "class": "Malware Characteristic:Payload"
                },
                "relation": "is distributed, a command-and-control (C&C) server is used to",
                "object": {
                    "text": "deploy and install the backdoor",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Trickbot",
                    "class": "Malware"
                },
                "relation": "connected to",
                "object": {
                    "text": "BazarLoader",
                    "class": "Malware"
                }
            }
        ],
        "response_time": 20.81830930709839,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/trendmicro/Ryuk.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1371,
                "cost": 0.013710000000000002
            },
            "output": {
                "tokens": 543,
                "cost": 0.01629
            },
            "total": {
                "tokens": 1914,
                "cost": 0.03
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "Ryuk",
                    "mention_class": "Malware",
                    "entity_id": 1,
                    "mentions_merged": [
                        "Ryuk"
                    ],
                    "entity_text": "Ryuk"
                },
                "relation": "began using",
                "object": {
                    "mention_id": 1,
                    "mention_text": "BazarLoader",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "BazarLoader",
                        "BazarLoader",
                        "BazarBackdoor",
                        "BazarLoader",
                        "BazarLoader"
                    ],
                    "entity_text": "BazarLoader"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "BazarLoader",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "BazarLoader",
                        "BazarLoader",
                        "BazarBackdoor",
                        "BazarLoader",
                        "BazarLoader"
                    ],
                    "entity_text": "BazarLoader"
                },
                "relation": "is known as",
                "object": {
                    "mention_id": 3,
                    "mention_text": "BazarBackdoor",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "BazarLoader",
                        "BazarLoader",
                        "BazarBackdoor",
                        "BazarLoader",
                        "BazarLoader"
                    ],
                    "entity_text": "BazarLoader"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "BazarLoader",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "BazarLoader",
                        "BazarLoader",
                        "BazarBackdoor",
                        "BazarLoader",
                        "BazarLoader"
                    ],
                    "entity_text": "BazarLoader"
                },
                "relation": "is primarily distributed via",
                "object": {
                    "mention_id": 5,
                    "mention_text": "phishing emails",
                    "mention_class": "Indicator:Email",
                    "entity_id": 4,
                    "mentions_merged": [
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails"
                    ],
                    "entity_text": "phishing emails"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "phishing emails",
                    "mention_class": "Indicator:Email",
                    "entity_id": 4,
                    "mentions_merged": [
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails"
                    ],
                    "entity_text": "phishing emails"
                },
                "relation": "contain",
                "object": {
                    "mention_id": 7,
                    "mention_text": "malicious attachments",
                    "mention_class": "Malware Characteristic:Payload",
                    "entity_id": 5,
                    "mentions_merged": [
                        "malicious attachments"
                    ],
                    "entity_text": "malicious attachments"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "phishing emails",
                    "mention_class": "Indicator:Email",
                    "entity_id": 4,
                    "mentions_merged": [
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails"
                    ],
                    "entity_text": "phishing emails"
                },
                "relation": "contain",
                "object": {
                    "mention_id": 9,
                    "mention_text": "links to websites",
                    "mention_class": "Indicator:URL",
                    "entity_id": 7,
                    "mentions_merged": [
                        "links to websites",
                        "websites"
                    ],
                    "entity_text": "websites"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "websites",
                    "mention_class": "Indicator:URL",
                    "entity_id": 7,
                    "mentions_merged": [
                        "links to websites",
                        "websites"
                    ],
                    "entity_text": "websites"
                },
                "relation": "host",
                "object": {
                    "mention_id": 11,
                    "mention_text": "malware",
                    "mention_class": "Malware",
                    "entity_id": 2,
                    "mentions_merged": [
                        "malware"
                    ],
                    "entity_text": "malware"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "phishing emails",
                    "mention_class": "Indicator:Email",
                    "entity_id": 4,
                    "mentions_merged": [
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails"
                    ],
                    "entity_text": "phishing emails"
                },
                "relation": "use",
                "object": {
                    "mention_id": 13,
                    "mention_text": "social engineering techniques",
                    "mention_class": "Malware Characteristic:Behavior",
                    "entity_id": 8,
                    "mentions_merged": [
                        "social engineering techniques"
                    ],
                    "entity_text": "social engineering techniques"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "phishing emails",
                    "mention_class": "Indicator:Email",
                    "entity_id": 4,
                    "mentions_merged": [
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails",
                        "phishing emails"
                    ],
                    "entity_text": "phishing emails"
                },
                "relation": "disguised as",
                "object": {
                    "mention_id": 15,
                    "mention_text": "business correspondence",
                    "mention_class": "Information",
                    "entity_id": 9,
                    "mentions_merged": [
                        "business correspondence"
                    ],
                    "entity_text": "business correspondence"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "payload",
                    "mention_class": "Malware Characteristic:Payload",
                    "entity_id": 6,
                    "mentions_merged": [
                        "payload"
                    ],
                    "entity_text": "payload"
                },
                "relation": "is distributed, a command-and-control (C&C) server is used to",
                "object": {
                    "mention_id": 17,
                    "mention_text": "deploy and install the backdoor",
                    "mention_class": "Event",
                    "entity_id": 10,
                    "mentions_merged": [
                        "deploy and install the backdoor"
                    ],
                    "entity_text": "deploy and install the backdoor"
                }
            },
            {
                "subject": {
                    "mention_id": 18,
                    "mention_text": "Trickbot",
                    "mention_class": "Malware",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Trickbot"
                    ],
                    "entity_text": "Trickbot"
                },
                "relation": "connected to",
                "object": {
                    "mention_id": 19,
                    "mention_text": "BazarLoader",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "BazarLoader",
                        "BazarLoader",
                        "BazarBackdoor",
                        "BazarLoader",
                        "BazarLoader"
                    ],
                    "entity_text": "BazarLoader"
                }
            }
        ],
        "mentions_num": 20,
        "response_time": 4.2026941776275635,
        "embedding_model": "text-embedding-3-large",
        "entity_num": 11
    },
    "LP": {
        "predicted_links": [
            {
                "subject": {
                    "entity_id": 10,
                    "mention_text": "deploy and install the backdoor"
                },
                "relation": "used to deploy and install",
                "object": {
                    "mention_id": 1,
                    "mention_text": "BazarLoader",
                    "mention_class": "Malware",
                    "entity_id": 0,
                    "mentions_merged": [
                        "BazarLoader",
                        "BazarLoader",
                        "BazarBackdoor",
                        "BazarLoader",
                        "BazarLoader"
                    ],
                    "entity_text": "BazarLoader"
                }
            }
        ],
        "response_time": 0.9021739959716797,
        "model": "gpt-3.5-turbo-0125",
        "usage": {
            "input": {
                "tokens": 446,
                "cost": 0.000223
            },
            "output": {
                "tokens": 37,
                "cost": 5.55e-05
            },
            "total": {
                "tokens": 483,
                "cost": 0.0002785
            }
        },
        "topic_node": {
            "mention_id": 1,
            "mention_text": "BazarLoader",
            "mention_class": "Malware",
            "entity_id": 0,
            "mentions_merged": [
                "BazarLoader",
                "BazarLoader",
                "BazarBackdoor",
                "BazarLoader",
                "BazarLoader"
            ],
            "entity_text": "BazarLoader"
        },
        "main_nodes": [
            {
                "mention_id": 17,
                "mention_text": "deploy and install the backdoor",
                "mention_class": "Event",
                "entity_id": 10,
                "mentions_merged": [
                    "deploy and install the backdoor"
                ],
                "entity_text": "deploy and install the backdoor"
            }
        ],
        "subgraphs": [
            [
                0,
                1,
                2,
                3,
                4,
                5,
                7,
                8,
                9
            ],
            [
                10,
                6
            ]
        ],
        "subgraph_num": 2,
        "Eval": {
            "correct": 1,
            "incorrect": 0
        }
    }
}