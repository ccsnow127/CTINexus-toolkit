{
    "CTI": {
        "text": "More than 3,000 Internet-accessible Apache ActiveMQ Servers are exposed to a critical remote code execution vulnerability that an attacker has begun actively targeting to drop ransomware. The Apache Software Foundation (ASF) disclosed the vulnerability, tracked as CVE-2023-46604, on Oct. 27. The bug allows a remote attacker with access to an ActiveMQ message broker to execute arbitrary commands on affected systems. Proof-of-concept exploit code and full details of the vulnerability are publicly available, meaning that threat actors have both the means and the information to launch attacks against the vulnerability. Researchers at Rapid7 reported observing exploit activity targeting the flaw at two customer locations, starting the same day that ASF disclosed the threat. In both instances, the adversary attempted to deploy ransomware binaries on target systems in an effort to ransom the victim organizations. They described both targeted organizations as running outdated versions of Apache ActiveMQ. The researchers attributed the malicious activity to the HelloKitty ransomware family, based on the ransom note and other attack attributes. HelloKitty ransomware has been percolating in the wild since at least 2020. Its operators have tended to favor double-extortion attacks in which they have not just encrypted the data but also stolen it as additional leverage for extracting a ransom from victims. The HelloKitty ransomware attacks leveraging the ActiveMQ flaw appeared somewhat rudimentary. In one of the attacks, the threat actor made more than a half dozen attempts to encrypt the data, prompting the researchers to label to threat actor as 'clumsy' in their report.",
        "link": "https://www.darkreading.com/cyberattacks-data-breaches/attackers-target-max-severity-apache-activemq-bug-to-drop-ransomware"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Internet-accessible Apache ActiveMQ Servers",
                "relation": "are exposed to",
                "object": "a critical remote code execution vulnerability"
            },
            {
                "subject": "An attacker",
                "relation": "has begun actively targeting",
                "object": "to drop ransomware"
            },
            {
                "subject": "The Apache Software Foundation",
                "relation": "disclosed",
                "object": "CVE-2023-46604"
            },
            {
                "subject": "CVE-2023-46604",
                "relation": "allows",
                "object": "a remote attacker with access to execute arbitrary commands"
            },
            {
                "subject": "Threat actors",
                "relation": "have",
                "object": "the means and the information to launch attacks"
            },
            {
                "subject": "Researchers at Rapid7",
                "relation": "reported observing exploit activity",
                "object": "targeting the flaw"
            },
            {
                "subject": "The adversary",
                "relation": "attempted to deploy",
                "object": "ransomware binaries"
            },
            {
                "subject": "Targeted organizations",
                "relation": "were running",
                "object": "outdated versions of Apache ActiveMQ"
            },
            {
                "subject": "The malicious activity",
                "relation": "is attributed to",
                "object": "the HelloKitty ransomware family"
            },
            {
                "subject": "HelloKitty ransomware",
                "relation": "favors",
                "object": "double-extortion attacks"
            },
            {
                "subject": "HelloKitty ransomware",
                "relation": "has been percolating in the wild since",
                "object": "at least 2020"
            },
            {
                "subject": "Double-extortion attacks",
                "relation": "involve",
                "object": "encrypting the data"
            },
            {
                "subject": "Double-extortion attacks",
                "relation": "involve",
                "object": "stealing the data"
            },
            {
                "subject": "The threat actor",
                "relation": "made attempts",
                "object": "to encrypt the data"
            },
            {
                "subject": "Researchers",
                "relation": "label the threat actor as",
                "object": "'clumsy'"
            }
        ],
        "triples_count": 15,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2674,
                "cost": 0.026740000000000003
            },
            "output": {
                "tokens": 434,
                "cost": 0.01302
            },
            "total": {
                "tokens": 3108,
                "cost": 0.039760000000000004
            }
        },
        "time": 10.859208822250366,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/darkreading/apache-activemq-QD1-IaO.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "AVERTIUM-mallox.json",
                    0.15490063626090297
                ],
                [
                    "AVERTIUM-ragnar.json",
                    0.1628075788464158
                ],
                [
                    "BleepingComputer-atlassian.json",
                    0.16295004613033448
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "Internet-accessible Apache ActiveMQ Servers",
                    "class": "Infrastructure"
                },
                "relation": "are exposed to",
                "object": {
                    "text": "a critical remote code execution vulnerability",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "An attacker",
                    "class": "Attacker"
                },
                "relation": "has begun actively targeting",
                "object": {
                    "text": "to drop ransomware",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "The Apache Software Foundation",
                    "class": "Organization"
                },
                "relation": "disclosed",
                "object": {
                    "text": "CVE-2023-46604",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "CVE-2023-46604",
                    "class": "Vulnerability"
                },
                "relation": "allows",
                "object": {
                    "text": "a remote attacker with access to execute arbitrary commands",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Threat actors",
                    "class": "Attacker"
                },
                "relation": "have",
                "object": {
                    "text": "the means and the information to launch attacks",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Researchers at Rapid7",
                    "class": "Organization"
                },
                "relation": "reported observing exploit activity",
                "object": {
                    "text": "targeting the flaw",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "The adversary",
                    "class": "Attacker"
                },
                "relation": "attempted to deploy",
                "object": {
                    "text": "ransomware binaries",
                    "class": "Malware Characteristic:Payload"
                }
            },
            {
                "subject": {
                    "text": "Targeted organizations",
                    "class": "Organization"
                },
                "relation": "were running",
                "object": {
                    "text": "outdated versions of Apache ActiveMQ",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "The malicious activity",
                    "class": "Event"
                },
                "relation": "is attributed to",
                "object": {
                    "text": "the HelloKitty ransomware family",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "HelloKitty ransomware",
                    "class": "Malware"
                },
                "relation": "favors",
                "object": {
                    "text": "double-extortion attacks",
                    "class": "Malware Characteristic:Behavior"
                }
            },
            {
                "subject": {
                    "text": "HelloKitty ransomware",
                    "class": "Malware"
                },
                "relation": "has been percolating in the wild since",
                "object": {
                    "text": "at least 2020",
                    "class": "Time"
                }
            },
            {
                "subject": {
                    "text": "Double-extortion attacks",
                    "class": "Malware Characteristic:Behavior"
                },
                "relation": "involve",
                "object": {
                    "text": "encrypting the data",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Double-extortion attacks",
                    "class": "Malware Characteristic:Behavior"
                },
                "relation": "involve",
                "object": {
                    "text": "stealing the data",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "The threat actor",
                    "class": "Attacker"
                },
                "relation": "made attempts",
                "object": {
                    "text": "to encrypt the data",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Researchers",
                    "class": "Organization"
                },
                "relation": "label the threat actor as",
                "object": {
                    "text": "'clumsy'",
                    "class": "Information"
                }
            }
        ],
        "response_time": 30.426883697509766,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/darkreading/apache-activemq.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1631,
                "cost": 0.01631
            },
            "output": {
                "tokens": 978,
                "cost": 0.02934
            },
            "total": {
                "tokens": 2609,
                "cost": 0.04565
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "Internet-accessible Apache ActiveMQ Servers",
                    "mention_class": "Infrastructure",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Internet-accessible Apache ActiveMQ Servers"
                    ],
                    "entity_text": "Internet-accessible Apache ActiveMQ Servers"
                },
                "relation": "are exposed to",
                "object": {
                    "mention_id": 1,
                    "mention_text": "a critical remote code execution vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 2,
                    "mentions_merged": [
                        "a critical remote code execution vulnerability"
                    ],
                    "entity_text": "a critical remote code execution vulnerability"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "An attacker",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                },
                "relation": "has begun actively targeting",
                "object": {
                    "mention_id": 3,
                    "mention_text": "to drop ransomware",
                    "mention_class": "Event",
                    "entity_id": 6,
                    "mentions_merged": [
                        "to drop ransomware"
                    ],
                    "entity_text": "to drop ransomware"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "The Apache Software Foundation",
                    "mention_class": "Organization",
                    "entity_id": 11,
                    "mentions_merged": [
                        "The Apache Software Foundation"
                    ],
                    "entity_text": "The Apache Software Foundation"
                },
                "relation": "disclosed",
                "object": {
                    "mention_id": 5,
                    "mention_text": "CVE-2023-46604",
                    "mention_class": "Vulnerability",
                    "entity_id": 1,
                    "mentions_merged": [
                        "CVE-2023-46604",
                        "CVE-2023-46604"
                    ],
                    "entity_text": "CVE-2023-46604"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "CVE-2023-46604",
                    "mention_class": "Vulnerability",
                    "entity_id": 1,
                    "mentions_merged": [
                        "CVE-2023-46604",
                        "CVE-2023-46604"
                    ],
                    "entity_text": "CVE-2023-46604"
                },
                "relation": "allows",
                "object": {
                    "mention_id": 7,
                    "mention_text": "a remote attacker with access to execute arbitrary commands",
                    "mention_class": "Event",
                    "entity_id": 7,
                    "mentions_merged": [
                        "a remote attacker with access to execute arbitrary commands"
                    ],
                    "entity_text": "a remote attacker with access to execute arbitrary commands"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "Threat actors",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                },
                "relation": "have",
                "object": {
                    "mention_id": 9,
                    "mention_text": "the means and the information to launch attacks",
                    "mention_class": "Information",
                    "entity_id": 15,
                    "mentions_merged": [
                        "the means and the information to launch attacks"
                    ],
                    "entity_text": "the means and the information to launch attacks"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "Researchers at Rapid7",
                    "mention_class": "Organization",
                    "entity_id": 12,
                    "mentions_merged": [
                        "Researchers at Rapid7"
                    ],
                    "entity_text": "Researchers at Rapid7"
                },
                "relation": "reported observing exploit activity",
                "object": {
                    "mention_id": 11,
                    "mention_text": "targeting the flaw",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "targeting the flaw"
                    ],
                    "entity_text": "targeting the flaw"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "The adversary",
                    "mention_class": "Attacker",
                    "entity_id": 4,
                    "mentions_merged": [
                        "The adversary"
                    ],
                    "entity_text": "The adversary"
                },
                "relation": "attempted to deploy",
                "object": {
                    "mention_id": 13,
                    "mention_text": "ransomware binaries",
                    "mention_class": "Malware Characteristic:Payload",
                    "entity_id": 18,
                    "mentions_merged": [
                        "ransomware binaries"
                    ],
                    "entity_text": "ransomware binaries"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "Targeted organizations",
                    "mention_class": "Organization",
                    "entity_id": 13,
                    "mentions_merged": [
                        "Targeted organizations"
                    ],
                    "entity_text": "Targeted organizations"
                },
                "relation": "were running",
                "object": {
                    "mention_id": 15,
                    "mention_text": "outdated versions of Apache ActiveMQ",
                    "mention_class": "Information",
                    "entity_id": 16,
                    "mentions_merged": [
                        "outdated versions of Apache ActiveMQ"
                    ],
                    "entity_text": "outdated versions of Apache ActiveMQ"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "The malicious activity",
                    "mention_class": "Event",
                    "entity_id": 9,
                    "mentions_merged": [
                        "The malicious activity"
                    ],
                    "entity_text": "The malicious activity"
                },
                "relation": "is attributed to",
                "object": {
                    "mention_id": 17,
                    "mention_text": "the HelloKitty ransomware family",
                    "mention_class": "Malware",
                    "entity_id": 19,
                    "mentions_merged": [
                        "the HelloKitty ransomware family",
                        "HelloKitty ransomware",
                        "HelloKitty ransomware"
                    ],
                    "entity_text": "HelloKitty ransomware"
                }
            },
            {
                "subject": {
                    "mention_id": 18,
                    "mention_text": "HelloKitty ransomware",
                    "mention_class": "Malware",
                    "entity_id": 19,
                    "mentions_merged": [
                        "the HelloKitty ransomware family",
                        "HelloKitty ransomware",
                        "HelloKitty ransomware"
                    ],
                    "entity_text": "HelloKitty ransomware"
                },
                "relation": "favors",
                "object": {
                    "mention_id": 19,
                    "mention_text": "double-extortion attacks",
                    "mention_class": "Malware Characteristic:Behavior",
                    "entity_id": 20,
                    "mentions_merged": [
                        "Double-extortion attacks",
                        "double-extortion attacks",
                        "Double-extortion attacks"
                    ],
                    "entity_text": "Double-extortion attacks"
                }
            },
            {
                "subject": {
                    "mention_id": 20,
                    "mention_text": "HelloKitty ransomware",
                    "mention_class": "Malware",
                    "entity_id": 19,
                    "mentions_merged": [
                        "the HelloKitty ransomware family",
                        "HelloKitty ransomware",
                        "HelloKitty ransomware"
                    ],
                    "entity_text": "HelloKitty ransomware"
                },
                "relation": "has been percolating in the wild since",
                "object": {
                    "mention_id": 21,
                    "mention_text": "at least 2020",
                    "mention_class": "Time",
                    "entity_id": 21,
                    "mentions_merged": [
                        "at least 2020"
                    ],
                    "entity_text": "at least 2020"
                }
            },
            {
                "subject": {
                    "mention_id": 22,
                    "mention_text": "Double-extortion attacks",
                    "mention_class": "Malware Characteristic:Behavior",
                    "entity_id": 20,
                    "mentions_merged": [
                        "Double-extortion attacks",
                        "double-extortion attacks",
                        "Double-extortion attacks"
                    ],
                    "entity_text": "Double-extortion attacks"
                },
                "relation": "involve",
                "object": {
                    "mention_id": 23,
                    "mention_text": "encrypting the data",
                    "mention_class": "Event",
                    "entity_id": 5,
                    "mentions_merged": [
                        "to encrypt the data",
                        "encrypting the data"
                    ],
                    "entity_text": "to encrypt the data"
                }
            },
            {
                "subject": {
                    "mention_id": 24,
                    "mention_text": "Double-extortion attacks",
                    "mention_class": "Malware Characteristic:Behavior",
                    "entity_id": 20,
                    "mentions_merged": [
                        "Double-extortion attacks",
                        "double-extortion attacks",
                        "Double-extortion attacks"
                    ],
                    "entity_text": "Double-extortion attacks"
                },
                "relation": "involve",
                "object": {
                    "mention_id": 25,
                    "mention_text": "stealing the data",
                    "mention_class": "Event",
                    "entity_id": 10,
                    "mentions_merged": [
                        "stealing the data"
                    ],
                    "entity_text": "stealing the data"
                }
            },
            {
                "subject": {
                    "mention_id": 26,
                    "mention_text": "The threat actor",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                },
                "relation": "made attempts",
                "object": {
                    "mention_id": 27,
                    "mention_text": "to encrypt the data",
                    "mention_class": "Event",
                    "entity_id": 5,
                    "mentions_merged": [
                        "to encrypt the data",
                        "encrypting the data"
                    ],
                    "entity_text": "to encrypt the data"
                }
            },
            {
                "subject": {
                    "mention_id": 28,
                    "mention_text": "Researchers",
                    "mention_class": "Organization",
                    "entity_id": 14,
                    "mentions_merged": [
                        "Researchers"
                    ],
                    "entity_text": "Researchers"
                },
                "relation": "label the threat actor as",
                "object": {
                    "mention_id": 29,
                    "mention_text": "'clumsy'",
                    "mention_class": "Information",
                    "entity_id": 17,
                    "mentions_merged": [
                        "'clumsy'"
                    ],
                    "entity_text": "'clumsy'"
                }
            }
        ],
        "mentions_num": 30,
        "response_time": 6.1247718334198,
        "embedding_model": "text-embedding-3-large",
        "entity_num": 22
    },
    "LP": {
        "predicted_links": [
            {
                "subject": {
                    "entity_id": 0,
                    "mention_text": "Internet-accessible Apache ActiveMQ Servers"
                },
                "relation": "are targeted by",
                "object": {
                    "mention_id": 2,
                    "mention_text": "An attacker",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "An attacker",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                },
                "relation": "targets",
                "object": {
                    "entity_id": 1,
                    "mention_text": "CVE-2023-46604"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "An attacker",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                },
                "relation": "targets",
                "object": {
                    "entity_id": 8,
                    "mention_text": "targeting the flaw"
                }
            },
            {
                "subject": {
                    "entity_id": 18,
                    "mention_text": "ransomware binaries"
                },
                "relation": "are used by",
                "object": {
                    "mention_id": 2,
                    "mention_text": "An attacker",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                }
            },
            {
                "subject": {
                    "entity_id": 16,
                    "mention_text": "outdated versions of Apache ActiveMQ"
                },
                "relation": "is targeted by",
                "object": {
                    "mention_id": 2,
                    "mention_text": "An attacker",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                }
            },
            {
                "subject": {
                    "entity_id": 17,
                    "mention_text": "'clumsy'"
                },
                "relation": "is",
                "object": {
                    "mention_id": 2,
                    "mention_text": "An attacker",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Threat actors",
                        "An attacker",
                        "The threat actor"
                    ],
                    "entity_text": "An attacker"
                }
            }
        ],
        "response_time": 6.324772834777832,
        "model": "gpt-3.5-turbo-0125",
        "usage": {
            "input": {
                "tokens": 5266,
                "cost": 0.0026329999999999995
            },
            "output": {
                "tokens": 215,
                "cost": 0.0003225000000000001
            },
            "total": {
                "tokens": 5481,
                "cost": 0.0029554999999999994
            }
        },
        "topic_node": {
            "mention_id": 2,
            "mention_text": "An attacker",
            "mention_class": "Attacker",
            "entity_id": 3,
            "mentions_merged": [
                "Threat actors",
                "An attacker",
                "The threat actor"
            ],
            "entity_text": "An attacker"
        },
        "main_nodes": [
            {
                "mention_id": 0,
                "mention_text": "Internet-accessible Apache ActiveMQ Servers",
                "mention_class": "Infrastructure",
                "entity_id": 0,
                "mentions_merged": [
                    "Internet-accessible Apache ActiveMQ Servers"
                ],
                "entity_text": "Internet-accessible Apache ActiveMQ Servers"
            },
            {
                "mention_id": 5,
                "mention_text": "CVE-2023-46604",
                "mention_class": "Vulnerability",
                "entity_id": 1,
                "mentions_merged": [
                    "CVE-2023-46604",
                    "CVE-2023-46604"
                ],
                "entity_text": "CVE-2023-46604"
            },
            {
                "mention_id": 11,
                "mention_text": "targeting the flaw",
                "mention_class": "Event",
                "entity_id": 8,
                "mentions_merged": [
                    "targeting the flaw"
                ],
                "entity_text": "targeting the flaw"
            },
            {
                "mention_id": 13,
                "mention_text": "ransomware binaries",
                "mention_class": "Malware Characteristic:Payload",
                "entity_id": 18,
                "mentions_merged": [
                    "ransomware binaries"
                ],
                "entity_text": "ransomware binaries"
            },
            {
                "mention_id": 15,
                "mention_text": "outdated versions of Apache ActiveMQ",
                "mention_class": "Information",
                "entity_id": 16,
                "mentions_merged": [
                    "outdated versions of Apache ActiveMQ"
                ],
                "entity_text": "outdated versions of Apache ActiveMQ"
            },
            {
                "mention_id": 29,
                "mention_text": "'clumsy'",
                "mention_class": "Information",
                "entity_id": 17,
                "mentions_merged": [
                    "'clumsy'"
                ],
                "entity_text": "'clumsy'"
            }
        ],
        "subgraphs": [
            [
                0,
                2
            ],
            [
                3,
                5,
                6,
                9,
                10,
                15,
                19,
                20,
                21
            ],
            [
                1,
                11,
                7
            ],
            [
                8,
                12
            ],
            [
                18,
                4
            ],
            [
                16,
                13
            ],
            [
                17,
                14
            ]
        ],
        "subgraph_num": 7,
        "Eval": {
            "correct": 4,
            "incorrect": 2
        }
    }
}