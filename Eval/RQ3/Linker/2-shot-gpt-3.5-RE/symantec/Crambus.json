{
    "CTI": {
        "text": "The Iranian Crambus espionage group (aka OilRig, APT34) staged an eight-month-long intrusion against a government in the Middle East between February and September 2023. During the compromise, the attackers stole files and passwords and, in one case, installed a PowerShell backdoor (dubbed PowerExchange) that was used to monitor incoming mails sent from an Exchange Server in order to execute commands sent by the attackers in the form of emails, and surreptitiously forwarded results  to the attackers. Malicious activity occurred on at least 12 computers and there is evidence that the attackers deployed backdoors and keyloggers on dozens more. In addition to deploying malware, the attackers made frequent use of the publicly available network administration tool Plink to configure port-forwarding rules on compromised machines, enabling remote access via the Remote Desktop Protocol (RDP). There is also evidence the attackers modified Windows firewall rules in order to enable remote access.",
        "link": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/crambus-middle-east-government"
    },
    "IE": {
        "triplets": [
            {
                "subject": "The Iranian Crambus espionage group",
                "relation": "is known as",
                "object": "OilRig"
            },
            {
                "subject": "The Iranian Crambus espionage group",
                "relation": "is known as",
                "object": "APT34"
            },
            {
                "subject": "The Iranian Crambus espionage group",
                "relation": "staged",
                "object": "an eight-month-long intrusion"
            },
            {
                "subject": "The intrusion",
                "relation": "targeted",
                "object": "a government in the Middle East"
            },
            {
                "subject": "attackers",
                "relation": "stole",
                "object": "files"
            },
            {
                "subject": "attackers",
                "relation": "stole",
                "object": "passwords"
            },
            {
                "subject": "attackers",
                "relation": "installed",
                "object": "a PowerShell backdoor"
            },
            {
                "subject": "The PowerShell backdoor",
                "relation": "is dubbed",
                "object": "PowerExchange"
            },
            {
                "subject": "PowerExchange",
                "relation": "was used to monitor",
                "object": "incoming mails"
            },
            {
                "subject": "PowerExchange",
                "relation": "executed",
                "object": "commands sent by the attackers"
            },
            {
                "subject": "PowerExchange",
                "relation": "forwarded",
                "object": "results to the attackers"
            },
            {
                "subject": "Malicious activity",
                "relation": "occurred on",
                "object": "at least 12 computers"
            },
            {
                "subject": "attackers",
                "relation": "deployed",
                "object": "backdoors"
            },
            {
                "subject": "attackers",
                "relation": "deployed",
                "object": "keyloggers"
            },
            {
                "subject": "The attackers",
                "relation": "made use of",
                "object": "Plink"
            },
            {
                "subject": "Plink",
                "relation": "to configure",
                "object": "port-forwarding rules"
            },
            {
                "subject": "port-forwarding rules",
                "relation": "enable",
                "object": "remote access via RDP"
            },
            {
                "subject": "attackers",
                "relation": "modified",
                "object": "Windows firewall rules"
            },
            {
                "subject": "Windows firewall rules",
                "relation": "enable",
                "object": "remote access"
            }
        ],
        "triples_count": 19,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1942,
                "cost": 0.019420000000000003
            },
            "output": {
                "tokens": 454,
                "cost": 0.01362
            },
            "total": {
                "tokens": 2396,
                "cost": 0.03304
            }
        },
        "time": 11.69729232788086,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/symantec/Crambus-QD1-xeR.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-github.json",
                    0.10149218992930456
                ],
                [
                    "BleepingComputer-mastodon.json",
                    0.10563173340217791
                ],
                [
                    "AVERTIUM-charming-kitten.json",
                    0.12206996804023774
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "The Iranian Crambus espionage group",
                    "class": "Attacker"
                },
                "relation": "is known as",
                "object": {
                    "text": "OilRig",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "The Iranian Crambus espionage group",
                    "class": "Attacker"
                },
                "relation": "is known as",
                "object": {
                    "text": "APT34",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "The Iranian Crambus espionage group",
                    "class": "Attacker"
                },
                "relation": "staged",
                "object": {
                    "text": "an eight-month-long intrusion",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "The intrusion",
                    "class": "Event"
                },
                "relation": "targeted",
                "object": {
                    "text": "a government in the Middle East",
                    "class": "Organization"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "stole",
                "object": {
                    "text": "files",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "stole",
                "object": {
                    "text": "passwords",
                    "class": "Credential"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "installed",
                "object": {
                    "text": "a PowerShell backdoor",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "The PowerShell backdoor",
                    "class": "Malware"
                },
                "relation": "is dubbed",
                "object": {
                    "text": "PowerExchange",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "PowerExchange",
                    "class": "Malware"
                },
                "relation": "was used to monitor",
                "object": {
                    "text": "incoming mails",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "PowerExchange",
                    "class": "Malware"
                },
                "relation": "executed",
                "object": {
                    "text": "commands sent by the attackers",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "PowerExchange",
                    "class": "Malware"
                },
                "relation": "forwarded",
                "object": {
                    "text": "results to the attackers",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Malicious activity",
                    "class": "Event"
                },
                "relation": "occurred on",
                "object": {
                    "text": "at least 12 computers",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "deployed",
                "object": {
                    "text": "backdoors",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "deployed",
                "object": {
                    "text": "keyloggers",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "The attackers",
                    "class": "Attacker"
                },
                "relation": "made use of",
                "object": {
                    "text": "Plink",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "Plink",
                    "class": "Tool"
                },
                "relation": "to configure",
                "object": {
                    "text": "port-forwarding rules",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "port-forwarding rules",
                    "class": "Information"
                },
                "relation": "enable",
                "object": {
                    "text": "remote access via RDP",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "modified",
                "object": {
                    "text": "Windows firewall rules",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Windows firewall rules",
                    "class": "Information"
                },
                "relation": "enable",
                "object": {
                    "text": "remote access",
                    "class": "Information"
                }
            }
        ],
        "response_time": 28.57882046699524,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/symantec/Crambus.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1744,
                "cost": 0.01744
            },
            "output": {
                "tokens": 953,
                "cost": 0.02859
            },
            "total": {
                "tokens": 2697,
                "cost": 0.04603
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "The Iranian Crambus espionage group",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "The Iranian Crambus espionage group",
                        "The Iranian Crambus espionage group",
                        "The Iranian Crambus espionage group"
                    ],
                    "entity_text": "The Iranian Crambus espionage group"
                },
                "relation": "is known as",
                "object": {
                    "mention_id": 1,
                    "mention_text": "OilRig",
                    "mention_class": "Attacker",
                    "entity_id": 2,
                    "mentions_merged": [
                        "OilRig"
                    ],
                    "entity_text": "OilRig"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "The Iranian Crambus espionage group",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "The Iranian Crambus espionage group",
                        "The Iranian Crambus espionage group",
                        "The Iranian Crambus espionage group"
                    ],
                    "entity_text": "The Iranian Crambus espionage group"
                },
                "relation": "is known as",
                "object": {
                    "mention_id": 3,
                    "mention_text": "APT34",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "APT34"
                    ],
                    "entity_text": "APT34"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "The Iranian Crambus espionage group",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "The Iranian Crambus espionage group",
                        "The Iranian Crambus espionage group",
                        "The Iranian Crambus espionage group"
                    ],
                    "entity_text": "The Iranian Crambus espionage group"
                },
                "relation": "staged",
                "object": {
                    "mention_id": 5,
                    "mention_text": "an eight-month-long intrusion",
                    "mention_class": "Event",
                    "entity_id": 4,
                    "mentions_merged": [
                        "an eight-month-long intrusion",
                        "The intrusion"
                    ],
                    "entity_text": "The intrusion"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "The intrusion",
                    "mention_class": "Event",
                    "entity_id": 4,
                    "mentions_merged": [
                        "an eight-month-long intrusion",
                        "The intrusion"
                    ],
                    "entity_text": "The intrusion"
                },
                "relation": "targeted",
                "object": {
                    "mention_id": 7,
                    "mention_text": "a government in the Middle East",
                    "mention_class": "Organization",
                    "entity_id": 6,
                    "mentions_merged": [
                        "a government in the Middle East"
                    ],
                    "entity_text": "a government in the Middle East"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                },
                "relation": "stole",
                "object": {
                    "mention_id": 9,
                    "mention_text": "files",
                    "mention_class": "Information",
                    "entity_id": 11,
                    "mentions_merged": [
                        "files"
                    ],
                    "entity_text": "files"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                },
                "relation": "stole",
                "object": {
                    "mention_id": 11,
                    "mention_text": "passwords",
                    "mention_class": "Credential",
                    "entity_id": 14,
                    "mentions_merged": [
                        "passwords"
                    ],
                    "entity_text": "passwords"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                },
                "relation": "installed",
                "object": {
                    "mention_id": 13,
                    "mention_text": "a PowerShell backdoor",
                    "mention_class": "Malware",
                    "entity_id": 15,
                    "mentions_merged": [
                        "a PowerShell backdoor",
                        "The PowerShell backdoor"
                    ],
                    "entity_text": "a PowerShell backdoor"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "The PowerShell backdoor",
                    "mention_class": "Malware",
                    "entity_id": 15,
                    "mentions_merged": [
                        "a PowerShell backdoor",
                        "The PowerShell backdoor"
                    ],
                    "entity_text": "a PowerShell backdoor"
                },
                "relation": "is dubbed",
                "object": {
                    "mention_id": 15,
                    "mention_text": "PowerExchange",
                    "mention_class": "Malware",
                    "entity_id": 16,
                    "mentions_merged": [
                        "PowerExchange",
                        "PowerExchange",
                        "PowerExchange",
                        "PowerExchange"
                    ],
                    "entity_text": "PowerExchange"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "PowerExchange",
                    "mention_class": "Malware",
                    "entity_id": 16,
                    "mentions_merged": [
                        "PowerExchange",
                        "PowerExchange",
                        "PowerExchange",
                        "PowerExchange"
                    ],
                    "entity_text": "PowerExchange"
                },
                "relation": "was used to monitor",
                "object": {
                    "mention_id": 17,
                    "mention_text": "incoming mails",
                    "mention_class": "Information",
                    "entity_id": 12,
                    "mentions_merged": [
                        "incoming mails"
                    ],
                    "entity_text": "incoming mails"
                }
            },
            {
                "subject": {
                    "mention_id": 18,
                    "mention_text": "PowerExchange",
                    "mention_class": "Malware",
                    "entity_id": 16,
                    "mentions_merged": [
                        "PowerExchange",
                        "PowerExchange",
                        "PowerExchange",
                        "PowerExchange"
                    ],
                    "entity_text": "PowerExchange"
                },
                "relation": "executed",
                "object": {
                    "mention_id": 19,
                    "mention_text": "commands sent by the attackers",
                    "mention_class": "Information",
                    "entity_id": 7,
                    "mentions_merged": [
                        "commands sent by the attackers",
                        "results to the attackers"
                    ],
                    "entity_text": "results to the attackers"
                }
            },
            {
                "subject": {
                    "mention_id": 20,
                    "mention_text": "PowerExchange",
                    "mention_class": "Malware",
                    "entity_id": 16,
                    "mentions_merged": [
                        "PowerExchange",
                        "PowerExchange",
                        "PowerExchange",
                        "PowerExchange"
                    ],
                    "entity_text": "PowerExchange"
                },
                "relation": "forwarded",
                "object": {
                    "mention_id": 21,
                    "mention_text": "results to the attackers",
                    "mention_class": "Information",
                    "entity_id": 7,
                    "mentions_merged": [
                        "commands sent by the attackers",
                        "results to the attackers"
                    ],
                    "entity_text": "results to the attackers"
                }
            },
            {
                "subject": {
                    "mention_id": 22,
                    "mention_text": "Malicious activity",
                    "mention_class": "Event",
                    "entity_id": 5,
                    "mentions_merged": [
                        "Malicious activity"
                    ],
                    "entity_text": "Malicious activity"
                },
                "relation": "occurred on",
                "object": {
                    "mention_id": 23,
                    "mention_text": "at least 12 computers",
                    "mention_class": "Information",
                    "entity_id": 13,
                    "mentions_merged": [
                        "at least 12 computers"
                    ],
                    "entity_text": "at least 12 computers"
                }
            },
            {
                "subject": {
                    "mention_id": 24,
                    "mention_text": "attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                },
                "relation": "deployed",
                "object": {
                    "mention_id": 25,
                    "mention_text": "backdoors",
                    "mention_class": "Malware",
                    "entity_id": 17,
                    "mentions_merged": [
                        "backdoors"
                    ],
                    "entity_text": "backdoors"
                }
            },
            {
                "subject": {
                    "mention_id": 26,
                    "mention_text": "attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                },
                "relation": "deployed",
                "object": {
                    "mention_id": 27,
                    "mention_text": "keyloggers",
                    "mention_class": "Malware",
                    "entity_id": 18,
                    "mentions_merged": [
                        "keyloggers"
                    ],
                    "entity_text": "keyloggers"
                }
            },
            {
                "subject": {
                    "mention_id": 28,
                    "mention_text": "The attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                },
                "relation": "made use of",
                "object": {
                    "mention_id": 29,
                    "mention_text": "Plink",
                    "mention_class": "Tool",
                    "entity_id": 19,
                    "mentions_merged": [
                        "Plink",
                        "Plink"
                    ],
                    "entity_text": "Plink"
                }
            },
            {
                "subject": {
                    "mention_id": 30,
                    "mention_text": "Plink",
                    "mention_class": "Tool",
                    "entity_id": 19,
                    "mentions_merged": [
                        "Plink",
                        "Plink"
                    ],
                    "entity_text": "Plink"
                },
                "relation": "to configure",
                "object": {
                    "mention_id": 31,
                    "mention_text": "port-forwarding rules",
                    "mention_class": "Information",
                    "entity_id": 8,
                    "mentions_merged": [
                        "port-forwarding rules",
                        "port-forwarding rules"
                    ],
                    "entity_text": "port-forwarding rules"
                }
            },
            {
                "subject": {
                    "mention_id": 32,
                    "mention_text": "port-forwarding rules",
                    "mention_class": "Information",
                    "entity_id": 8,
                    "mentions_merged": [
                        "port-forwarding rules",
                        "port-forwarding rules"
                    ],
                    "entity_text": "port-forwarding rules"
                },
                "relation": "enable",
                "object": {
                    "mention_id": 33,
                    "mention_text": "remote access via RDP",
                    "mention_class": "Information",
                    "entity_id": 9,
                    "mentions_merged": [
                        "remote access via RDP",
                        "remote access"
                    ],
                    "entity_text": "remote access"
                }
            },
            {
                "subject": {
                    "mention_id": 34,
                    "mention_text": "attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                },
                "relation": "modified",
                "object": {
                    "mention_id": 35,
                    "mention_text": "Windows firewall rules",
                    "mention_class": "Information",
                    "entity_id": 10,
                    "mentions_merged": [
                        "Windows firewall rules",
                        "Windows firewall rules"
                    ],
                    "entity_text": "Windows firewall rules"
                }
            },
            {
                "subject": {
                    "mention_id": 36,
                    "mention_text": "Windows firewall rules",
                    "mention_class": "Information",
                    "entity_id": 10,
                    "mentions_merged": [
                        "Windows firewall rules",
                        "Windows firewall rules"
                    ],
                    "entity_text": "Windows firewall rules"
                },
                "relation": "enable",
                "object": {
                    "mention_id": 37,
                    "mention_text": "remote access",
                    "mention_class": "Information",
                    "entity_id": 9,
                    "mentions_merged": [
                        "remote access via RDP",
                        "remote access"
                    ],
                    "entity_text": "remote access"
                }
            }
        ],
        "mentions_num": 38,
        "response_time": 8.247072219848633,
        "embedding_model": "text-embedding-3-large",
        "entity_num": 20
    },
    "LP": {
        "predicted_links": [
            {
                "subject": {
                    "entity_id": 0,
                    "mention_text": "The Iranian Crambus espionage group"
                },
                "relation": "are",
                "object": {
                    "mention_id": 8,
                    "mention_text": "attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                }
            },
            {
                "subject": {
                    "entity_id": 13,
                    "mention_text": "at least 12 computers"
                },
                "relation": "were targeted by",
                "object": {
                    "mention_id": 8,
                    "mention_text": "attackers",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "attackers",
                        "The attackers"
                    ],
                    "entity_text": "attackers"
                }
            }
        ],
        "response_time": 1.7564964294433594,
        "model": "gpt-3.5-turbo-0125",
        "usage": {
            "input": {
                "tokens": 1512,
                "cost": 0.0007559999999999999
            },
            "output": {
                "tokens": 75,
                "cost": 0.0001125
            },
            "total": {
                "tokens": 1587,
                "cost": 0.0008685
            }
        },
        "topic_node": {
            "mention_id": 8,
            "mention_text": "attackers",
            "mention_class": "Attacker",
            "entity_id": 1,
            "mentions_merged": [
                "attackers",
                "attackers",
                "attackers",
                "attackers",
                "attackers",
                "attackers",
                "The attackers"
            ],
            "entity_text": "attackers"
        },
        "main_nodes": [
            {
                "mention_id": 0,
                "mention_text": "The Iranian Crambus espionage group",
                "mention_class": "Attacker",
                "entity_id": 0,
                "mentions_merged": [
                    "The Iranian Crambus espionage group",
                    "The Iranian Crambus espionage group",
                    "The Iranian Crambus espionage group"
                ],
                "entity_text": "The Iranian Crambus espionage group"
            },
            {
                "mention_id": 23,
                "mention_text": "at least 12 computers",
                "mention_class": "Information",
                "entity_id": 13,
                "mentions_merged": [
                    "at least 12 computers"
                ],
                "entity_text": "at least 12 computers"
            }
        ],
        "subgraphs": [
            [
                0,
                2,
                3,
                4,
                6
            ],
            [
                1,
                7,
                8,
                9,
                10,
                11,
                12,
                14,
                15,
                16,
                17,
                18,
                19
            ],
            [
                13,
                5
            ]
        ],
        "subgraph_num": 3,
        "Eval": {
            "correct": 0,
            "incorrect": 2
        }
    }
}