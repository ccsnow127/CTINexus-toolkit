{
    "CTI": {
        "text": "Unit 42 researchers discovered a security risk in the Google Workspace (formerly known as G Suite) domain-wide delegation feature. We exposed an unexpected way to gain access to the Google Workspace domain data from Google Cloud Platform (GCP). We found that a GCP identity with the necessary permission can generate an access token to a delegated user. A malicious insider or an external attacker with stolen credentials can use this access token to impersonate Google Workspace users, granting unauthorized access to their data or to perform operations on their behalf.",
        "link": "https://unit42.paloaltonetworks.com/critical-risk-in-google-workspace-delegation-feature/"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Unit 42 researchers",
                "relation": "discovered",
                "object": "a security risk"
            },
            {
                "subject": "a security risk",
                "relation": "is in",
                "object": "the Google Workspace domain-wide delegation feature"
            },
            {
                "subject": "A GCP identity",
                "relation": "can generate",
                "object": "an access token"
            },
            {
                "subject": "an access token",
                "relation": "to",
                "object": "a delegated user"
            },
            {
                "subject": "A malicious insider or an external attacker",
                "relation": "use",
                "object": "this access token"
            },
            {
                "subject": "this access token",
                "relation": "to impersonate",
                "object": "Google Workspace users"
            },
            {
                "subject": "A malicious insider or an external attacker",
                "relation": "grant",
                "object": "unauthorized access"
            },
            {
                "subject": "unauthorized access",
                "relation": "to",
                "object": "their data"
            },
            {
                "subject": "A malicious insider or an external attacker",
                "relation": "perform operations on",
                "object": "their behalf"
            }
        ],
        "triples_count": 9,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2355,
                "cost": 0.02355
            },
            "output": {
                "tokens": 229,
                "cost": 0.00687
            },
            "total": {
                "tokens": 2584,
                "cost": 0.030420000000000003
            }
        },
        "time": 5.792339563369751,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/Unit42/Google-Workspace-QD1-VDW.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "AVERTIUM-mallox.json",
                    0.058308618460348675
                ],
                [
                    "BleepingComputer-mastodon.json",
                    0.061130894354750234
                ],
                [
                    "BleepingComputer-chrome.json",
                    0.1194516904305824
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "Unit 42 researchers",
                    "class": "Organization"
                },
                "relation": "discovered",
                "object": {
                    "text": "a security risk",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "a security risk",
                    "class": "Information"
                },
                "relation": "is in",
                "object": {
                    "text": "the Google Workspace domain-wide delegation feature",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "A GCP identity",
                    "class": "Information"
                },
                "relation": "can generate",
                "object": {
                    "text": "an access token",
                    "class": "Credential"
                }
            },
            {
                "subject": {
                    "text": "an access token",
                    "class": "Credential"
                },
                "relation": "to",
                "object": {
                    "text": "a delegated user",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "A malicious insider or an external attacker",
                    "class": "Attacker"
                },
                "relation": "use",
                "object": {
                    "text": "this access token",
                    "class": "Credential"
                }
            },
            {
                "subject": {
                    "text": "this access token",
                    "class": "Credential"
                },
                "relation": "to impersonate",
                "object": {
                    "text": "Google Workspace users",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "A malicious insider or an external attacker",
                    "class": "Attacker"
                },
                "relation": "grant",
                "object": {
                    "text": "unauthorized access",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "unauthorized access",
                    "class": "Event"
                },
                "relation": "to",
                "object": {
                    "text": "their data",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "A malicious insider or an external attacker",
                    "class": "Attacker"
                },
                "relation": "perform operations on",
                "object": {
                    "text": "their behalf",
                    "class": "Event"
                }
            }
        ],
        "response_time": 17.977315187454224,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/Unit42/Google-Workspace.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1329,
                "cost": 0.013290000000000001
            },
            "output": {
                "tokens": 461,
                "cost": 0.01383
            },
            "total": {
                "tokens": 1790,
                "cost": 0.027120000000000002
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "Unit 42 researchers",
                    "mention_class": "Organization",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Unit 42 researchers"
                    ],
                    "entity_text": "Unit 42 researchers"
                },
                "relation": "discovered",
                "object": {
                    "mention_id": 1,
                    "mention_text": "a security risk",
                    "mention_class": "Information",
                    "entity_id": 1,
                    "mentions_merged": [
                        "a security risk",
                        "a security risk"
                    ],
                    "entity_text": "a security risk"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "a security risk",
                    "mention_class": "Information",
                    "entity_id": 1,
                    "mentions_merged": [
                        "a security risk",
                        "a security risk"
                    ],
                    "entity_text": "a security risk"
                },
                "relation": "is in",
                "object": {
                    "mention_id": 3,
                    "mention_text": "the Google Workspace domain-wide delegation feature",
                    "mention_class": "Information",
                    "entity_id": 2,
                    "mentions_merged": [
                        "Google Workspace users",
                        "the Google Workspace domain-wide delegation feature"
                    ],
                    "entity_text": "Google Workspace users"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "A GCP identity",
                    "mention_class": "Information",
                    "entity_id": 3,
                    "mentions_merged": [
                        "A GCP identity"
                    ],
                    "entity_text": "A GCP identity"
                },
                "relation": "can generate",
                "object": {
                    "mention_id": 5,
                    "mention_text": "an access token",
                    "mention_class": "Credential",
                    "entity_id": 6,
                    "mentions_merged": [
                        "this access token",
                        "this access token",
                        "an access token",
                        "an access token"
                    ],
                    "entity_text": "this access token"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "an access token",
                    "mention_class": "Credential",
                    "entity_id": 6,
                    "mentions_merged": [
                        "this access token",
                        "this access token",
                        "an access token",
                        "an access token"
                    ],
                    "entity_text": "this access token"
                },
                "relation": "to",
                "object": {
                    "mention_id": 7,
                    "mention_text": "a delegated user",
                    "mention_class": "Information",
                    "entity_id": 4,
                    "mentions_merged": [
                        "a delegated user"
                    ],
                    "entity_text": "a delegated user"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "A malicious insider or an external attacker",
                    "mention_class": "Attacker",
                    "entity_id": 7,
                    "mentions_merged": [
                        "A malicious insider or an external attacker",
                        "A malicious insider or an external attacker",
                        "A malicious insider or an external attacker"
                    ],
                    "entity_text": "A malicious insider or an external attacker"
                },
                "relation": "use",
                "object": {
                    "mention_id": 9,
                    "mention_text": "this access token",
                    "mention_class": "Credential",
                    "entity_id": 6,
                    "mentions_merged": [
                        "this access token",
                        "this access token",
                        "an access token",
                        "an access token"
                    ],
                    "entity_text": "this access token"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "this access token",
                    "mention_class": "Credential",
                    "entity_id": 6,
                    "mentions_merged": [
                        "this access token",
                        "this access token",
                        "an access token",
                        "an access token"
                    ],
                    "entity_text": "this access token"
                },
                "relation": "to impersonate",
                "object": {
                    "mention_id": 11,
                    "mention_text": "Google Workspace users",
                    "mention_class": "Information",
                    "entity_id": 2,
                    "mentions_merged": [
                        "Google Workspace users",
                        "the Google Workspace domain-wide delegation feature"
                    ],
                    "entity_text": "Google Workspace users"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "A malicious insider or an external attacker",
                    "mention_class": "Attacker",
                    "entity_id": 7,
                    "mentions_merged": [
                        "A malicious insider or an external attacker",
                        "A malicious insider or an external attacker",
                        "A malicious insider or an external attacker"
                    ],
                    "entity_text": "A malicious insider or an external attacker"
                },
                "relation": "grant",
                "object": {
                    "mention_id": 13,
                    "mention_text": "unauthorized access",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "unauthorized access",
                        "unauthorized access"
                    ],
                    "entity_text": "unauthorized access"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "unauthorized access",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "unauthorized access",
                        "unauthorized access"
                    ],
                    "entity_text": "unauthorized access"
                },
                "relation": "to",
                "object": {
                    "mention_id": 15,
                    "mention_text": "their data",
                    "mention_class": "Information",
                    "entity_id": 5,
                    "mentions_merged": [
                        "their data"
                    ],
                    "entity_text": "their data"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "A malicious insider or an external attacker",
                    "mention_class": "Attacker",
                    "entity_id": 7,
                    "mentions_merged": [
                        "A malicious insider or an external attacker",
                        "A malicious insider or an external attacker",
                        "A malicious insider or an external attacker"
                    ],
                    "entity_text": "A malicious insider or an external attacker"
                },
                "relation": "perform operations on",
                "object": {
                    "mention_id": 17,
                    "mention_text": "their behalf",
                    "mention_class": "Event",
                    "entity_id": 9,
                    "mentions_merged": [
                        "their behalf"
                    ],
                    "entity_text": "their behalf"
                }
            }
        ],
        "mentions_num": 18,
        "response_time": 2.6424131393432617,
        "embedding_model": "text-embedding-3-small",
        "entity_num": 10,
        "threshold": 0.6,
        "Eval": {
            "TP": 11,
            "FP": 2,
            "FN": 0,
            "TN": 5
        }
    }
}