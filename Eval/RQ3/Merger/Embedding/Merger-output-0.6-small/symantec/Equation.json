{
    "CTI": {
        "text": "Equation has employed a number of specialist tools. Among these are Trojan.Grokey a custom keylogger (also known as \u201cGrok\u201d) and W32.Fanni, which is also known as \u201cFanny worm\u201d. This worm's chief purpose appears to be the targeting of air-gapped networks. It can receive commands and exfiltrate data through infected USB sticks. Fanny used two zero day exploits that were also used in the Stuxnet attacks. The exploits were used in Fanny prior to Stuxnet indicating that Equation had prior knowledge of the vulnerabilities. Another similarity lies in the fact that Stuxnet was also designed to attack air-gapped networks.",
        "link": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/equation-cyberespionage-group"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Equation",
                "relation": "employed",
                "object": "specialist tools"
            },
            {
                "subject": "Among the tools",
                "relation": "are",
                "object": "Trojan.Grokey"
            },
            {
                "subject": "Trojan.Grokey",
                "relation": "is also known as",
                "object": "\"Grok\""
            },
            {
                "subject": "Among the tools",
                "relation": "are",
                "object": "W32.Fanni"
            },
            {
                "subject": "W32.Fanni",
                "relation": "is also known as",
                "object": "\"Fanny worm\""
            },
            {
                "subject": "Fanny worm",
                "relation": "targets",
                "object": "air-gapped networks"
            },
            {
                "subject": "Fanny",
                "relation": "can receive commands through",
                "object": "infected USB sticks"
            },
            {
                "subject": "Fanny",
                "relation": "exfiltrates data through",
                "object": "infected USB sticks"
            },
            {
                "subject": "Fanny",
                "relation": "used",
                "object": "two zero day exploits"
            },
            {
                "subject": "The exploits",
                "relation": "were used in",
                "object": "Fanny prior to Stuxnet"
            },
            {
                "subject": "Equation",
                "relation": "had prior knowledge of",
                "object": "the vulnerabilities"
            },
            {
                "subject": "Stuxnet",
                "relation": "was designed to attack",
                "object": "air-gapped networks"
            }
        ],
        "triples_count": 12,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2913,
                "cost": 0.029130000000000003
            },
            "output": {
                "tokens": 388,
                "cost": 0.011640000000000001
            },
            "total": {
                "tokens": 3301,
                "cost": 0.04077
            }
        },
        "time": 11.166350603103638,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/symantec/Equation-QD1-SHQ.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-vmware.json",
                    0.05457364156659209
                ],
                [
                    "AVERTIUM-mallox.json",
                    0.05573564441654058
                ],
                [
                    "AVERTIUM-fivehands.json",
                    0.056980923308727366
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "Equation",
                    "class": "Attacker"
                },
                "relation": "employed",
                "object": {
                    "text": "specialist tools",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "Among the tools",
                    "class": "Tool"
                },
                "relation": "are",
                "object": {
                    "text": "Trojan.Grokey",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "Trojan.Grokey",
                    "class": "Malware"
                },
                "relation": "is also known as",
                "object": {
                    "text": "\"Grok\"",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "Among the tools",
                    "class": "Tool"
                },
                "relation": "are",
                "object": {
                    "text": "W32.Fanni",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "W32.Fanni",
                    "class": "Malware"
                },
                "relation": "is also known as",
                "object": {
                    "text": "\"Fanny worm\"",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "Fanny worm",
                    "class": "Malware"
                },
                "relation": "targets",
                "object": {
                    "text": "air-gapped networks",
                    "class": "Exploit Target"
                }
            },
            {
                "subject": {
                    "text": "Fanny",
                    "class": "Malware"
                },
                "relation": "can receive commands through",
                "object": {
                    "text": "infected USB sticks",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "Fanny",
                    "class": "Malware"
                },
                "relation": "exfiltrates data through",
                "object": {
                    "text": "infected USB sticks",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "Fanny",
                    "class": "Malware"
                },
                "relation": "used",
                "object": {
                    "text": "two zero day exploits",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "The exploits",
                    "class": "Vulnerability"
                },
                "relation": "were used in",
                "object": {
                    "text": "Fanny prior to Stuxnet",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Equation",
                    "class": "Attacker"
                },
                "relation": "had prior knowledge of",
                "object": {
                    "text": "the vulnerabilities",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "Stuxnet",
                    "class": "Malware"
                },
                "relation": "was designed to attack",
                "object": {
                    "text": "air-gapped networks",
                    "class": "Exploit Target"
                }
            }
        ],
        "response_time": 28.935338735580444,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/symantec/Equation.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1459,
                "cost": 0.01459
            },
            "output": {
                "tokens": 747,
                "cost": 0.02241
            },
            "total": {
                "tokens": 2206,
                "cost": 0.037
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "Equation",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Equation",
                        "Equation"
                    ],
                    "entity_text": "Equation"
                },
                "relation": "employed",
                "object": {
                    "mention_id": 1,
                    "mention_text": "specialist tools",
                    "mention_class": "Tool",
                    "entity_id": 1,
                    "mentions_merged": [
                        "specialist tools",
                        "Among the tools",
                        "Among the tools"
                    ],
                    "entity_text": "Among the tools"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "Among the tools",
                    "mention_class": "Tool",
                    "entity_id": 1,
                    "mentions_merged": [
                        "specialist tools",
                        "Among the tools",
                        "Among the tools"
                    ],
                    "entity_text": "Among the tools"
                },
                "relation": "are",
                "object": {
                    "mention_id": 3,
                    "mention_text": "Trojan.Grokey",
                    "mention_class": "Malware",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Trojan.Grokey",
                        "Trojan.Grokey"
                    ],
                    "entity_text": "Trojan.Grokey"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "Trojan.Grokey",
                    "mention_class": "Malware",
                    "entity_id": 3,
                    "mentions_merged": [
                        "Trojan.Grokey",
                        "Trojan.Grokey"
                    ],
                    "entity_text": "Trojan.Grokey"
                },
                "relation": "is also known as",
                "object": {
                    "mention_id": 5,
                    "mention_text": "\"Grok\"",
                    "mention_class": "Malware",
                    "entity_id": 6,
                    "mentions_merged": [
                        "\"Grok\""
                    ],
                    "entity_text": "\"Grok\""
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "Among the tools",
                    "mention_class": "Tool",
                    "entity_id": 1,
                    "mentions_merged": [
                        "specialist tools",
                        "Among the tools",
                        "Among the tools"
                    ],
                    "entity_text": "Among the tools"
                },
                "relation": "are",
                "object": {
                    "mention_id": 7,
                    "mention_text": "W32.Fanni",
                    "mention_class": "Malware",
                    "entity_id": 4,
                    "mentions_merged": [
                        "W32.Fanni",
                        "W32.Fanni"
                    ],
                    "entity_text": "W32.Fanni"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "W32.Fanni",
                    "mention_class": "Malware",
                    "entity_id": 4,
                    "mentions_merged": [
                        "W32.Fanni",
                        "W32.Fanni"
                    ],
                    "entity_text": "W32.Fanni"
                },
                "relation": "is also known as",
                "object": {
                    "mention_id": 9,
                    "mention_text": "\"Fanny worm\"",
                    "mention_class": "Malware",
                    "entity_id": 5,
                    "mentions_merged": [
                        "\"Fanny worm\"",
                        "Fanny worm",
                        "Fanny",
                        "Fanny",
                        "Fanny"
                    ],
                    "entity_text": "Fanny"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "Fanny worm",
                    "mention_class": "Malware",
                    "entity_id": 5,
                    "mentions_merged": [
                        "\"Fanny worm\"",
                        "Fanny worm",
                        "Fanny",
                        "Fanny",
                        "Fanny"
                    ],
                    "entity_text": "Fanny"
                },
                "relation": "targets",
                "object": {
                    "mention_id": 11,
                    "mention_text": "air-gapped networks",
                    "mention_class": "Exploit Target",
                    "entity_id": 8,
                    "mentions_merged": [
                        "air-gapped networks",
                        "air-gapped networks"
                    ],
                    "entity_text": "air-gapped networks"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "Fanny",
                    "mention_class": "Malware",
                    "entity_id": 5,
                    "mentions_merged": [
                        "\"Fanny worm\"",
                        "Fanny worm",
                        "Fanny",
                        "Fanny",
                        "Fanny"
                    ],
                    "entity_text": "Fanny"
                },
                "relation": "can receive commands through",
                "object": {
                    "mention_id": 13,
                    "mention_text": "infected USB sticks",
                    "mention_class": "Tool",
                    "entity_id": 2,
                    "mentions_merged": [
                        "infected USB sticks",
                        "infected USB sticks"
                    ],
                    "entity_text": "infected USB sticks"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "Fanny",
                    "mention_class": "Malware",
                    "entity_id": 5,
                    "mentions_merged": [
                        "\"Fanny worm\"",
                        "Fanny worm",
                        "Fanny",
                        "Fanny",
                        "Fanny"
                    ],
                    "entity_text": "Fanny"
                },
                "relation": "exfiltrates data through",
                "object": {
                    "mention_id": 15,
                    "mention_text": "infected USB sticks",
                    "mention_class": "Tool",
                    "entity_id": 2,
                    "mentions_merged": [
                        "infected USB sticks",
                        "infected USB sticks"
                    ],
                    "entity_text": "infected USB sticks"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "Fanny",
                    "mention_class": "Malware",
                    "entity_id": 5,
                    "mentions_merged": [
                        "\"Fanny worm\"",
                        "Fanny worm",
                        "Fanny",
                        "Fanny",
                        "Fanny"
                    ],
                    "entity_text": "Fanny"
                },
                "relation": "used",
                "object": {
                    "mention_id": 17,
                    "mention_text": "two zero day exploits",
                    "mention_class": "Vulnerability",
                    "entity_id": 9,
                    "mentions_merged": [
                        "two zero day exploits",
                        "The exploits",
                        "the vulnerabilities"
                    ],
                    "entity_text": "The exploits"
                }
            },
            {
                "subject": {
                    "mention_id": 18,
                    "mention_text": "The exploits",
                    "mention_class": "Vulnerability",
                    "entity_id": 9,
                    "mentions_merged": [
                        "two zero day exploits",
                        "The exploits",
                        "the vulnerabilities"
                    ],
                    "entity_text": "The exploits"
                },
                "relation": "were used in",
                "object": {
                    "mention_id": 19,
                    "mention_text": "Fanny prior to Stuxnet",
                    "mention_class": "Event",
                    "entity_id": 10,
                    "mentions_merged": [
                        "Fanny prior to Stuxnet"
                    ],
                    "entity_text": "Fanny prior to Stuxnet"
                }
            },
            {
                "subject": {
                    "mention_id": 20,
                    "mention_text": "Equation",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Equation",
                        "Equation"
                    ],
                    "entity_text": "Equation"
                },
                "relation": "had prior knowledge of",
                "object": {
                    "mention_id": 21,
                    "mention_text": "the vulnerabilities",
                    "mention_class": "Vulnerability",
                    "entity_id": 9,
                    "mentions_merged": [
                        "two zero day exploits",
                        "The exploits",
                        "the vulnerabilities"
                    ],
                    "entity_text": "The exploits"
                }
            },
            {
                "subject": {
                    "mention_id": 22,
                    "mention_text": "Stuxnet",
                    "mention_class": "Malware",
                    "entity_id": 7,
                    "mentions_merged": [
                        "Stuxnet"
                    ],
                    "entity_text": "Stuxnet"
                },
                "relation": "was designed to attack",
                "object": {
                    "mention_id": 23,
                    "mention_text": "air-gapped networks",
                    "mention_class": "Exploit Target",
                    "entity_id": 8,
                    "mentions_merged": [
                        "air-gapped networks",
                        "air-gapped networks"
                    ],
                    "entity_text": "air-gapped networks"
                }
            }
        ],
        "mentions_num": 24,
        "response_time": 3.527555465698242,
        "embedding_model": "text-embedding-3-small",
        "entity_num": 11,
        "threshold": 0.6,
        "Eval": {
            "TP": 17,
            "FP": 4,
            "FN": 0,
            "TN": 3
        }
    }
}