{
    "CTI": {
        "text": "Follina (CVE-2022-30190) is a vulnerability in the Microsoft Support Diagnostic Tool (MSDT) that allows remote code execution on vulnerable systems through the ms-msdt protocol handler scheme. The bug is present in all supported versions of Windows. The vulnerability can be easily exploited by a specially crafted Word document that downloads and loads a malicious HTML file through Word's remote template feature. The HTML file ultimately allows the attacker to load and execute PowerShell code within Windows. The vulnerability can also be exploited through the RTF file format.",
        "link": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/follina-msdt-exploit-malware"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Follina",
                "relation": "is a",
                "object": "vulnerability"
            },
            {
                "subject": "Follina",
                "relation": "is in",
                "object": "the Microsoft Support Diagnostic Tool (MSDT)"
            },
            {
                "subject": "Follina",
                "relation": "allows",
                "object": "remote code execution on vulnerable systems"
            },
            {
                "subject": "vulnerable systems",
                "relation": "through",
                "object": "the ms-msdt protocol handler scheme"
            },
            {
                "subject": "The bug",
                "relation": "is present in",
                "object": "all supported versions of Windows"
            },
            {
                "subject": "vulnerability",
                "relation": "can be exploited by",
                "object": "a specially crafted Word document"
            },
            {
                "subject": "a specially crafted Word document",
                "relation": "downloads and loads",
                "object": "a malicious HTML file"
            },
            {
                "subject": "a malicious HTML file",
                "relation": "through",
                "object": "Word's remote template feature"
            },
            {
                "subject": "The HTML file",
                "relation": "allows",
                "object": "the attacker to load and execute PowerShell code within Windows"
            },
            {
                "subject": "vulnerability",
                "relation": "can also be exploited through",
                "object": "the RTF file format"
            }
        ],
        "triples_count": 10,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1562,
                "cost": 0.015620000000000002
            },
            "output": {
                "tokens": 271,
                "cost": 0.00813
            },
            "total": {
                "tokens": 1833,
                "cost": 0.02375
            }
        },
        "time": 6.7688775062561035,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/symantec/Follina-QD1-FOo.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-chrome.json",
                    0.11698890474066682
                ],
                [
                    "BleepingComputer-atlassian.json",
                    0.13455400450733862
                ],
                [
                    "AVERTIUM-CVE-2023-36884.json",
                    0.148602380264633
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "Follina",
                    "class": "Vulnerability"
                },
                "relation": "is a",
                "object": {
                    "text": "vulnerability",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "Follina",
                    "class": "Vulnerability"
                },
                "relation": "is in",
                "object": {
                    "text": "the Microsoft Support Diagnostic Tool (MSDT)",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Follina",
                    "class": "Vulnerability"
                },
                "relation": "allows",
                "object": {
                    "text": "remote code execution on vulnerable systems",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "vulnerable systems",
                    "class": "Exploit Target"
                },
                "relation": "through",
                "object": {
                    "text": "the ms-msdt protocol handler scheme",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "The bug",
                    "class": "Vulnerability"
                },
                "relation": "is present in",
                "object": {
                    "text": "all supported versions of Windows",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "vulnerability",
                    "class": "Vulnerability"
                },
                "relation": "can be exploited by",
                "object": {
                    "text": "a specially crafted Word document",
                    "class": "Indicator:File"
                }
            },
            {
                "subject": {
                    "text": "a specially crafted Word document",
                    "class": "Indicator:File"
                },
                "relation": "downloads and loads",
                "object": {
                    "text": "a malicious HTML file",
                    "class": "Indicator:File"
                }
            },
            {
                "subject": {
                    "text": "a malicious HTML file",
                    "class": "Indicator:File"
                },
                "relation": "through",
                "object": {
                    "text": "Word's remote template feature",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "The HTML file",
                    "class": "Indicator:File"
                },
                "relation": "allows",
                "object": {
                    "text": "the attacker to load and execute PowerShell code within Windows",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "vulnerability",
                    "class": "Vulnerability"
                },
                "relation": "can also be exploited through",
                "object": {
                    "text": "the RTF file format",
                    "class": "Indicator:File"
                }
            }
        ],
        "response_time": 27.514467477798462,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/symantec/Follina.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1391,
                "cost": 0.01391
            },
            "output": {
                "tokens": 653,
                "cost": 0.01959
            },
            "total": {
                "tokens": 2044,
                "cost": 0.0335
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "Follina",
                    "mention_class": "Vulnerability",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Follina",
                        "Follina",
                        "Follina"
                    ],
                    "entity_text": "Follina"
                },
                "relation": "is a",
                "object": {
                    "mention_id": 1,
                    "mention_text": "vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 1,
                    "mentions_merged": [
                        "vulnerability",
                        "vulnerability",
                        "vulnerability"
                    ],
                    "entity_text": "vulnerability"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "Follina",
                    "mention_class": "Vulnerability",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Follina",
                        "Follina",
                        "Follina"
                    ],
                    "entity_text": "Follina"
                },
                "relation": "is in",
                "object": {
                    "mention_id": 3,
                    "mention_text": "the Microsoft Support Diagnostic Tool (MSDT)",
                    "mention_class": "Information",
                    "entity_id": 3,
                    "mentions_merged": [
                        "the Microsoft Support Diagnostic Tool (MSDT)"
                    ],
                    "entity_text": "the Microsoft Support Diagnostic Tool (MSDT)"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "Follina",
                    "mention_class": "Vulnerability",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Follina",
                        "Follina",
                        "Follina"
                    ],
                    "entity_text": "Follina"
                },
                "relation": "allows",
                "object": {
                    "mention_id": 5,
                    "mention_text": "remote code execution on vulnerable systems",
                    "mention_class": "Event",
                    "entity_id": 7,
                    "mentions_merged": [
                        "remote code execution on vulnerable systems"
                    ],
                    "entity_text": "remote code execution on vulnerable systems"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "vulnerable systems",
                    "mention_class": "Exploit Target",
                    "entity_id": 9,
                    "mentions_merged": [
                        "vulnerable systems"
                    ],
                    "entity_text": "vulnerable systems"
                },
                "relation": "through",
                "object": {
                    "mention_id": 7,
                    "mention_text": "the ms-msdt protocol handler scheme",
                    "mention_class": "Information",
                    "entity_id": 4,
                    "mentions_merged": [
                        "the ms-msdt protocol handler scheme"
                    ],
                    "entity_text": "the ms-msdt protocol handler scheme"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "The bug",
                    "mention_class": "Vulnerability",
                    "entity_id": 2,
                    "mentions_merged": [
                        "The bug"
                    ],
                    "entity_text": "The bug"
                },
                "relation": "is present in",
                "object": {
                    "mention_id": 9,
                    "mention_text": "all supported versions of Windows",
                    "mention_class": "Information",
                    "entity_id": 5,
                    "mentions_merged": [
                        "all supported versions of Windows"
                    ],
                    "entity_text": "all supported versions of Windows"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 1,
                    "mentions_merged": [
                        "vulnerability",
                        "vulnerability",
                        "vulnerability"
                    ],
                    "entity_text": "vulnerability"
                },
                "relation": "can be exploited by",
                "object": {
                    "mention_id": 11,
                    "mention_text": "a specially crafted Word document",
                    "mention_class": "Indicator:File",
                    "entity_id": 10,
                    "mentions_merged": [
                        "a specially crafted Word document",
                        "a specially crafted Word document"
                    ],
                    "entity_text": "a specially crafted Word document"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "a specially crafted Word document",
                    "mention_class": "Indicator:File",
                    "entity_id": 10,
                    "mentions_merged": [
                        "a specially crafted Word document",
                        "a specially crafted Word document"
                    ],
                    "entity_text": "a specially crafted Word document"
                },
                "relation": "downloads and loads",
                "object": {
                    "mention_id": 13,
                    "mention_text": "a malicious HTML file",
                    "mention_class": "Indicator:File",
                    "entity_id": 11,
                    "mentions_merged": [
                        "The HTML file",
                        "a malicious HTML file",
                        "a malicious HTML file"
                    ],
                    "entity_text": "a malicious HTML file"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "a malicious HTML file",
                    "mention_class": "Indicator:File",
                    "entity_id": 11,
                    "mentions_merged": [
                        "The HTML file",
                        "a malicious HTML file",
                        "a malicious HTML file"
                    ],
                    "entity_text": "a malicious HTML file"
                },
                "relation": "through",
                "object": {
                    "mention_id": 15,
                    "mention_text": "Word's remote template feature",
                    "mention_class": "Information",
                    "entity_id": 6,
                    "mentions_merged": [
                        "Word's remote template feature"
                    ],
                    "entity_text": "Word's remote template feature"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "The HTML file",
                    "mention_class": "Indicator:File",
                    "entity_id": 11,
                    "mentions_merged": [
                        "The HTML file",
                        "a malicious HTML file",
                        "a malicious HTML file"
                    ],
                    "entity_text": "a malicious HTML file"
                },
                "relation": "allows",
                "object": {
                    "mention_id": 17,
                    "mention_text": "the attacker to load and execute PowerShell code within Windows",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "the attacker to load and execute PowerShell code within Windows"
                    ],
                    "entity_text": "the attacker to load and execute PowerShell code within Windows"
                }
            },
            {
                "subject": {
                    "mention_id": 18,
                    "mention_text": "vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 1,
                    "mentions_merged": [
                        "vulnerability",
                        "vulnerability",
                        "vulnerability"
                    ],
                    "entity_text": "vulnerability"
                },
                "relation": "can also be exploited through",
                "object": {
                    "mention_id": 19,
                    "mention_text": "the RTF file format",
                    "mention_class": "Indicator:File",
                    "entity_id": 12,
                    "mentions_merged": [
                        "the RTF file format"
                    ],
                    "entity_text": "the RTF file format"
                }
            }
        ],
        "mentions_num": 20,
        "response_time": 4.033875226974487,
        "embedding_model": "text-embedding-3-large",
        "entity_num": 13,
        "threshold": 0.6,
        "Eval": {
            "TP": 11,
            "FP": 0,
            "FN": 0,
            "TN": 9
        }
    }
}