{
    "CTI": {
        "text": "To protect our users, Google\u2019s Threat Analysis Group (TAG) routinely hunts for 0-day vulnerabilities exploited in-the-wild. This blog will describe a 0-day vulnerability, discovered by TAG in late October 2022, embedded in malicious documents and used to target users in South Korea. We attribute this activity to a group of North Korean government-backed actors known as APT37. These malicious documents exploited an Internet Explorer 0-day vulnerability in the JScript engine, CVE-2022-41128. Our policy is to quickly report vulnerabilities to vendors, and within a few hours of discovering this 0-day, we reported it to Microsoft and patches were released to protect users from these attacks. This is not the first time APT37 has used Internet Explorer 0-day exploits to target users. The group has historically focused their targeting on South Korean users, North Korean defectors, policy makers, journalists and human rights activists.",
        "link": "https://blog.google/threat-analysis-group/internet-explorer-0-day-exploited-by-north-korean-actor-apt37/"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Google\u2019s Threat Analysis Group (TAG)",
                "relation": "routinely hunts for",
                "object": "0-day vulnerabilities"
            },
            {
                "subject": "Google\u2019s Threat Analysis Group (TAG)",
                "relation": "discovered",
                "object": "a 0-day vulnerability"
            },
            {
                "subject": "a 0-day vulnerability",
                "relation": "embedded in",
                "object": "malicious documents"
            },
            {
                "subject": "malicious documents",
                "relation": "used to target",
                "object": "users in South Korea"
            },
            {
                "subject": "activity",
                "relation": "is attributed to",
                "object": "APT37"
            },
            {
                "subject": "APT37",
                "relation": "is backed by",
                "object": "North Korean government"
            },
            {
                "subject": "malicious documents",
                "relation": "exploited",
                "object": "an Internet Explorer 0-day vulnerability"
            },
            {
                "subject": "an Internet Explorer 0-day vulnerability",
                "relation": "is in",
                "object": "the JScript engine"
            },
            {
                "subject": "an Internet Explorer 0-day vulnerability",
                "relation": "is",
                "object": "CVE-2022-41128"
            },
            {
                "subject": "Google\u2019s Threat Analysis Group (TAG)",
                "relation": "reported",
                "object": "vulnerability to Microsoft"
            },
            {
                "subject": "Microsoft",
                "relation": "released",
                "object": "patches"
            },
            {
                "subject": "APT37",
                "relation": "used",
                "object": "Internet Explorer 0-day exploits"
            },
            {
                "subject": "APT37",
                "relation": "targeted",
                "object": "South Korean users"
            },
            {
                "subject": "APT37",
                "relation": "targeted",
                "object": "North Korean defectors"
            },
            {
                "subject": "APT37",
                "relation": "targeted",
                "object": "policy makers"
            },
            {
                "subject": "APT37",
                "relation": "targeted",
                "object": "journalists"
            },
            {
                "subject": "APT37",
                "relation": "targeted",
                "object": "human rights activists"
            }
        ],
        "triples_count": 17,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2148,
                "cost": 0.021480000000000003
            },
            "output": {
                "tokens": 425,
                "cost": 0.012750000000000001
            },
            "total": {
                "tokens": 2573,
                "cost": 0.034230000000000003
            }
        },
        "time": 10.99002718925476,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/Google_TAG/apt37-QD1-wv0.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-apple.json",
                    0.11916692419700844
                ],
                [
                    "BleepingComputer-vmware.json",
                    0.1219611575004425
                ],
                [
                    "AVERTIUM-charming-kitten.json",
                    0.1335706592510583
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "Google\u2019s Threat Analysis Group (TAG)",
                    "class": "Organization"
                },
                "relation": "routinely hunts for",
                "object": {
                    "text": "0-day vulnerabilities",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "Google\u2019s Threat Analysis Group (TAG)",
                    "class": "Organization"
                },
                "relation": "discovered",
                "object": {
                    "text": "a 0-day vulnerability",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "a 0-day vulnerability",
                    "class": "Vulnerability"
                },
                "relation": "embedded in",
                "object": {
                    "text": "malicious documents",
                    "class": "Indicator:File"
                }
            },
            {
                "subject": {
                    "text": "malicious documents",
                    "class": "Indicator:File"
                },
                "relation": "used to target",
                "object": {
                    "text": "users in South Korea",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "activity",
                    "class": "Event"
                },
                "relation": "is attributed to",
                "object": {
                    "text": "APT37",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "APT37",
                    "class": "Attacker"
                },
                "relation": "is backed by",
                "object": {
                    "text": "North Korean government",
                    "class": "Organization"
                }
            },
            {
                "subject": {
                    "text": "malicious documents",
                    "class": "Indicator:File"
                },
                "relation": "exploited",
                "object": {
                    "text": "an Internet Explorer 0-day vulnerability",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "an Internet Explorer 0-day vulnerability",
                    "class": "Vulnerability"
                },
                "relation": "is in",
                "object": {
                    "text": "the JScript engine",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "an Internet Explorer 0-day vulnerability",
                    "class": "Vulnerability"
                },
                "relation": "is",
                "object": {
                    "text": "CVE-2022-41128",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "Google\u2019s Threat Analysis Group (TAG)",
                    "class": "Organization"
                },
                "relation": "reported",
                "object": {
                    "text": "vulnerability to Microsoft",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Microsoft",
                    "class": "Organization"
                },
                "relation": "released",
                "object": {
                    "text": "patches",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "APT37",
                    "class": "Attacker"
                },
                "relation": "used",
                "object": {
                    "text": "Internet Explorer 0-day exploits",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "APT37",
                    "class": "Attacker"
                },
                "relation": "targeted",
                "object": {
                    "text": "South Korean users",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "APT37",
                    "class": "Attacker"
                },
                "relation": "targeted",
                "object": {
                    "text": "North Korean defectors",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "APT37",
                    "class": "Attacker"
                },
                "relation": "targeted",
                "object": {
                    "text": "policy makers",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "APT37",
                    "class": "Attacker"
                },
                "relation": "targeted",
                "object": {
                    "text": "journalists",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "APT37",
                    "class": "Attacker"
                },
                "relation": "targeted",
                "object": {
                    "text": "human rights activists",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            }
        ],
        "response_time": 47.320950984954834,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/Google_TAG/apt37.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1677,
                "cost": 0.01677
            },
            "output": {
                "tokens": 1124,
                "cost": 0.03372
            },
            "total": {
                "tokens": 2801,
                "cost": 0.05049
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "Google\u2019s Threat Analysis Group (TAG)",
                    "mention_class": "Organization",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Google\u2019s Threat Analysis Group (TAG)",
                        "Google\u2019s Threat Analysis Group (TAG)",
                        "Google\u2019s Threat Analysis Group (TAG)"
                    ],
                    "entity_text": "Google\u2019s Threat Analysis Group (TAG)"
                },
                "relation": "routinely hunts for",
                "object": {
                    "mention_id": 1,
                    "mention_text": "0-day vulnerabilities",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "0-day vulnerabilities",
                        "a 0-day vulnerability",
                        "a 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "CVE-2022-41128",
                        "Internet Explorer 0-day exploits"
                    ],
                    "entity_text": "an Internet Explorer 0-day vulnerability"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "Google\u2019s Threat Analysis Group (TAG)",
                    "mention_class": "Organization",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Google\u2019s Threat Analysis Group (TAG)",
                        "Google\u2019s Threat Analysis Group (TAG)",
                        "Google\u2019s Threat Analysis Group (TAG)"
                    ],
                    "entity_text": "Google\u2019s Threat Analysis Group (TAG)"
                },
                "relation": "discovered",
                "object": {
                    "mention_id": 3,
                    "mention_text": "a 0-day vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "0-day vulnerabilities",
                        "a 0-day vulnerability",
                        "a 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "CVE-2022-41128",
                        "Internet Explorer 0-day exploits"
                    ],
                    "entity_text": "an Internet Explorer 0-day vulnerability"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "a 0-day vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "0-day vulnerabilities",
                        "a 0-day vulnerability",
                        "a 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "CVE-2022-41128",
                        "Internet Explorer 0-day exploits"
                    ],
                    "entity_text": "an Internet Explorer 0-day vulnerability"
                },
                "relation": "embedded in",
                "object": {
                    "mention_id": 5,
                    "mention_text": "malicious documents",
                    "mention_class": "Indicator:File",
                    "entity_id": 4,
                    "mentions_merged": [
                        "malicious documents",
                        "malicious documents",
                        "malicious documents"
                    ],
                    "entity_text": "malicious documents"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "malicious documents",
                    "mention_class": "Indicator:File",
                    "entity_id": 4,
                    "mentions_merged": [
                        "malicious documents",
                        "malicious documents",
                        "malicious documents"
                    ],
                    "entity_text": "malicious documents"
                },
                "relation": "used to target",
                "object": {
                    "mention_id": 7,
                    "mention_text": "users in South Korea",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 5,
                    "mentions_merged": [
                        "South Korean users",
                        "North Korean defectors",
                        "users in South Korea"
                    ],
                    "entity_text": "South Korean users"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "activity",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "activity"
                    ],
                    "entity_text": "activity"
                },
                "relation": "is attributed to",
                "object": {
                    "mention_id": 9,
                    "mention_text": "APT37",
                    "mention_class": "Attacker",
                    "entity_id": 10,
                    "mentions_merged": [
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37"
                    ],
                    "entity_text": "APT37"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "APT37",
                    "mention_class": "Attacker",
                    "entity_id": 10,
                    "mentions_merged": [
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37"
                    ],
                    "entity_text": "APT37"
                },
                "relation": "is backed by",
                "object": {
                    "mention_id": 11,
                    "mention_text": "North Korean government",
                    "mention_class": "Organization",
                    "entity_id": 1,
                    "mentions_merged": [
                        "North Korean government"
                    ],
                    "entity_text": "North Korean government"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "malicious documents",
                    "mention_class": "Indicator:File",
                    "entity_id": 4,
                    "mentions_merged": [
                        "malicious documents",
                        "malicious documents",
                        "malicious documents"
                    ],
                    "entity_text": "malicious documents"
                },
                "relation": "exploited",
                "object": {
                    "mention_id": 13,
                    "mention_text": "an Internet Explorer 0-day vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "0-day vulnerabilities",
                        "a 0-day vulnerability",
                        "a 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "CVE-2022-41128",
                        "Internet Explorer 0-day exploits"
                    ],
                    "entity_text": "an Internet Explorer 0-day vulnerability"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "an Internet Explorer 0-day vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "0-day vulnerabilities",
                        "a 0-day vulnerability",
                        "a 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "CVE-2022-41128",
                        "Internet Explorer 0-day exploits"
                    ],
                    "entity_text": "an Internet Explorer 0-day vulnerability"
                },
                "relation": "is in",
                "object": {
                    "mention_id": 15,
                    "mention_text": "the JScript engine",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 7,
                    "mentions_merged": [
                        "the JScript engine"
                    ],
                    "entity_text": "the JScript engine"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "an Internet Explorer 0-day vulnerability",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "0-day vulnerabilities",
                        "a 0-day vulnerability",
                        "a 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "CVE-2022-41128",
                        "Internet Explorer 0-day exploits"
                    ],
                    "entity_text": "an Internet Explorer 0-day vulnerability"
                },
                "relation": "is",
                "object": {
                    "mention_id": 17,
                    "mention_text": "CVE-2022-41128",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "0-day vulnerabilities",
                        "a 0-day vulnerability",
                        "a 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "CVE-2022-41128",
                        "Internet Explorer 0-day exploits"
                    ],
                    "entity_text": "an Internet Explorer 0-day vulnerability"
                }
            },
            {
                "subject": {
                    "mention_id": 18,
                    "mention_text": "Google\u2019s Threat Analysis Group (TAG)",
                    "mention_class": "Organization",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Google\u2019s Threat Analysis Group (TAG)",
                        "Google\u2019s Threat Analysis Group (TAG)",
                        "Google\u2019s Threat Analysis Group (TAG)"
                    ],
                    "entity_text": "Google\u2019s Threat Analysis Group (TAG)"
                },
                "relation": "reported",
                "object": {
                    "mention_id": 19,
                    "mention_text": "vulnerability to Microsoft",
                    "mention_class": "Event",
                    "entity_id": 9,
                    "mentions_merged": [
                        "vulnerability to Microsoft"
                    ],
                    "entity_text": "vulnerability to Microsoft"
                }
            },
            {
                "subject": {
                    "mention_id": 20,
                    "mention_text": "Microsoft",
                    "mention_class": "Organization",
                    "entity_id": 2,
                    "mentions_merged": [
                        "Microsoft"
                    ],
                    "entity_text": "Microsoft"
                },
                "relation": "released",
                "object": {
                    "mention_id": 21,
                    "mention_text": "patches",
                    "mention_class": "Information",
                    "entity_id": 11,
                    "mentions_merged": [
                        "patches"
                    ],
                    "entity_text": "patches"
                }
            },
            {
                "subject": {
                    "mention_id": 22,
                    "mention_text": "APT37",
                    "mention_class": "Attacker",
                    "entity_id": 10,
                    "mentions_merged": [
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37"
                    ],
                    "entity_text": "APT37"
                },
                "relation": "used",
                "object": {
                    "mention_id": 23,
                    "mention_text": "Internet Explorer 0-day exploits",
                    "mention_class": "Vulnerability",
                    "entity_id": 3,
                    "mentions_merged": [
                        "0-day vulnerabilities",
                        "a 0-day vulnerability",
                        "a 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "an Internet Explorer 0-day vulnerability",
                        "CVE-2022-41128",
                        "Internet Explorer 0-day exploits"
                    ],
                    "entity_text": "an Internet Explorer 0-day vulnerability"
                }
            },
            {
                "subject": {
                    "mention_id": 24,
                    "mention_text": "APT37",
                    "mention_class": "Attacker",
                    "entity_id": 10,
                    "mentions_merged": [
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37"
                    ],
                    "entity_text": "APT37"
                },
                "relation": "targeted",
                "object": {
                    "mention_id": 25,
                    "mention_text": "South Korean users",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 5,
                    "mentions_merged": [
                        "South Korean users",
                        "North Korean defectors",
                        "users in South Korea"
                    ],
                    "entity_text": "South Korean users"
                }
            },
            {
                "subject": {
                    "mention_id": 26,
                    "mention_text": "APT37",
                    "mention_class": "Attacker",
                    "entity_id": 10,
                    "mentions_merged": [
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37"
                    ],
                    "entity_text": "APT37"
                },
                "relation": "targeted",
                "object": {
                    "mention_id": 27,
                    "mention_text": "North Korean defectors",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 5,
                    "mentions_merged": [
                        "South Korean users",
                        "North Korean defectors",
                        "users in South Korea"
                    ],
                    "entity_text": "South Korean users"
                }
            },
            {
                "subject": {
                    "mention_id": 28,
                    "mention_text": "APT37",
                    "mention_class": "Attacker",
                    "entity_id": 10,
                    "mentions_merged": [
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37"
                    ],
                    "entity_text": "APT37"
                },
                "relation": "targeted",
                "object": {
                    "mention_id": 29,
                    "mention_text": "policy makers",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 6,
                    "mentions_merged": [
                        "human rights activists",
                        "policy makers",
                        "journalists"
                    ],
                    "entity_text": "journalists"
                }
            },
            {
                "subject": {
                    "mention_id": 30,
                    "mention_text": "APT37",
                    "mention_class": "Attacker",
                    "entity_id": 10,
                    "mentions_merged": [
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37"
                    ],
                    "entity_text": "APT37"
                },
                "relation": "targeted",
                "object": {
                    "mention_id": 31,
                    "mention_text": "journalists",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 6,
                    "mentions_merged": [
                        "human rights activists",
                        "policy makers",
                        "journalists"
                    ],
                    "entity_text": "journalists"
                }
            },
            {
                "subject": {
                    "mention_id": 32,
                    "mention_text": "APT37",
                    "mention_class": "Attacker",
                    "entity_id": 10,
                    "mentions_merged": [
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37",
                        "APT37"
                    ],
                    "entity_text": "APT37"
                },
                "relation": "targeted",
                "object": {
                    "mention_id": 33,
                    "mention_text": "human rights activists",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 6,
                    "mentions_merged": [
                        "human rights activists",
                        "policy makers",
                        "journalists"
                    ],
                    "entity_text": "journalists"
                }
            }
        ],
        "mentions_num": 34,
        "response_time": 7.41469669342041,
        "embedding_model": "text-embedding-3-large",
        "entity_num": 12,
        "threshold": 0.4,
        "Eval": {
            "TP": 23,
            "FP": 5,
            "FN": 0,
            "TN": 6
        }
    }
}