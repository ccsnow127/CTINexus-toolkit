{
    "CTI": {
        "text": "Although Ragnar Locker was discovered by the FBI in April 2020, the group has actually been active since December 2019. Ragnar Locker is both the name of the ransomware group and the name of the ransomware. The gang works as a part of a ransomware family, which means they are associated with several ransomware variants or threat actor groups. Ragnar Locker is known for using the double extortion tactic, which involves threat actors exfiltrating sensitive data, then triggering the encryption attack, and ultimately threatening to leak the data if the demanded ransom isn't paid. To avoid prevention and detection, the threat actor frequently changes their obfuscation techniques. Ragnar Locker initiates their attacks by compromising the networks of companies through RDP service - using brute force to guess passwords or using stolen credentials purchased on the dark web. After compromising their target's network, the threat actor elevates their privileges by exploiting CVE-2017-0213 found in Windows COM Aggregate Marshaler. According to Microsoft, CVE-2017-0213 is an elevation of privilege that allows attackers to run arbitrary code with elevated privileges. To exploit the vulnerability, the attacker runs a specially crafted application.",
        "link": "https://explore.avertium.com/resource/ragnar-locker-ransomware"
    },
    "IE": {
        "triplets": [
            {
                "subject": "Ragnar Locker",
                "relation": "was discovered by",
                "object": "the FBI"
            },
            {
                "subject": "Ragnar Locker",
                "relation": "is",
                "object": "a ransomware group"
            },
            {
                "subject": "Ragnar Locker",
                "relation": "is",
                "object": "the name of the ransomware"
            },
            {
                "subject": "The gang",
                "relation": "works as",
                "object": "a part of a ransomware family"
            },
            {
                "subject": "Ragnar Locker",
                "relation": "uses",
                "object": "the double extortion tactic"
            },
            {
                "subject": "Threat actors",
                "relation": "exfiltrating and triggering",
                "object": "encryption attack"
            },
            {
                "subject": "Threat actor",
                "relation": "changes",
                "object": "their obfuscation techniques"
            },
            {
                "subject": "Ragnar Locker",
                "relation": "initiates attacks by",
                "object": "compromising networks through RDP service"
            },
            {
                "subject": "The threat actor",
                "relation": "uses",
                "object": "brute force"
            },
            {
                "subject": "The threat actor",
                "relation": "purchases",
                "object": "stolen credentials on the dark web"
            },
            {
                "subject": "The threat actor",
                "relation": "elevates",
                "object": "their privileges"
            },
            {
                "subject": "The threat actor",
                "relation": "exploits",
                "object": "CVE-2017-0213"
            },
            {
                "subject": "CVE-2017-0213",
                "relation": "is an elevation of privilege in",
                "object": "Windows COM Aggregate Marshaler"
            },
            {
                "subject": "CVE-2017-0213",
                "relation": "allows attackers to",
                "object": "run arbitrary code with elevated privileges"
            },
            {
                "subject": "The attacker",
                "relation": "runs",
                "object": "a specially crafted application"
            }
        ],
        "triples_count": 15,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 3238,
                "cost": 0.032380000000000006
            },
            "output": {
                "tokens": 392,
                "cost": 0.01176
            },
            "total": {
                "tokens": 3630,
                "cost": 0.044140000000000006
            }
        },
        "time": 11.565404891967773,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/AVERTIUM/ragnar-QD1-SO5.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "AVERTIUM-fargo.json",
                    0.1483773002342417
                ],
                [
                    "AVERTIUM-mallox.json",
                    0.15197252506567782
                ],
                [
                    "AVERTIUM-yanluowang.json",
                    0.1576822961696763
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "Ragnar Locker",
                    "class": "Attacker"
                },
                "relation": "was discovered by",
                "object": {
                    "text": "the FBI",
                    "class": "Organization"
                }
            },
            {
                "subject": {
                    "text": "Ragnar Locker",
                    "class": "Attacker"
                },
                "relation": "is",
                "object": {
                    "text": "a ransomware group",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "Ragnar Locker",
                    "class": "Malware"
                },
                "relation": "is",
                "object": {
                    "text": "the name of the ransomware",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "The gang",
                    "class": "Attacker"
                },
                "relation": "works as",
                "object": {
                    "text": "a part of a ransomware family",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "Ragnar Locker",
                    "class": "Attacker"
                },
                "relation": "uses",
                "object": {
                    "text": "the double extortion tactic",
                    "class": "Malware Characteristic:Feature"
                }
            },
            {
                "subject": {
                    "text": "Threat actors",
                    "class": "Attacker"
                },
                "relation": "exfiltrating and triggering",
                "object": {
                    "text": "encryption attack",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Threat actor",
                    "class": "Attacker"
                },
                "relation": "changes",
                "object": {
                    "text": "their obfuscation techniques",
                    "class": "Malware Characteristic:Behavior"
                }
            },
            {
                "subject": {
                    "text": "Ragnar Locker",
                    "class": "Attacker"
                },
                "relation": "initiates attacks by",
                "object": {
                    "text": "compromising networks through RDP service",
                    "class": "Exploit Target"
                }
            },
            {
                "subject": {
                    "text": "The threat actor",
                    "class": "Attacker"
                },
                "relation": "uses",
                "object": {
                    "text": "brute force",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "The threat actor",
                    "class": "Attacker"
                },
                "relation": "purchases",
                "object": {
                    "text": "stolen credentials on the dark web",
                    "class": "Credential"
                }
            },
            {
                "subject": {
                    "text": "The threat actor",
                    "class": "Attacker"
                },
                "relation": "elevates",
                "object": {
                    "text": "their privileges",
                    "class": "Malware Characteristic:Capability"
                }
            },
            {
                "subject": {
                    "text": "The threat actor",
                    "class": "Attacker"
                },
                "relation": "exploits",
                "object": {
                    "text": "CVE-2017-0213",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "CVE-2017-0213",
                    "class": "Vulnerability"
                },
                "relation": "is an elevation of privilege in",
                "object": {
                    "text": "Windows COM Aggregate Marshaler",
                    "class": "Exploit Target"
                }
            },
            {
                "subject": {
                    "text": "CVE-2017-0213",
                    "class": "Vulnerability"
                },
                "relation": "allows attackers to",
                "object": {
                    "text": "run arbitrary code with elevated privileges",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "The attacker",
                    "class": "Attacker"
                },
                "relation": "runs",
                "object": {
                    "text": "a specially crafted application",
                    "class": "Tool"
                }
            }
        ],
        "response_time": 29.407845973968506,
        "Demo_num": 8,
        "tag_prompt": "/home/yutong/CTINexus/dataset/Tagger-output-gpt4-8-v2/prompt_store/AVERTIUM/ragnar.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1606,
                "cost": 0.01606
            },
            "output": {
                "tokens": 839,
                "cost": 0.02517
            },
            "total": {
                "tokens": 2445,
                "cost": 0.04123
            }
        }
    },
    "EA": {
        "aligned_triplets": [
            {
                "subject": {
                    "mention_id": 0,
                    "mention_text": "Ragnar Locker",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Ragnar Locker",
                        "Ragnar Locker",
                        "Ragnar Locker",
                        "Ragnar Locker"
                    ],
                    "entity_text": "Ragnar Locker"
                },
                "relation": "was discovered by",
                "object": {
                    "mention_id": 1,
                    "mention_text": "the FBI",
                    "mention_class": "Organization",
                    "entity_id": 4,
                    "mentions_merged": [
                        "the FBI"
                    ],
                    "entity_text": "the FBI"
                }
            },
            {
                "subject": {
                    "mention_id": 2,
                    "mention_text": "Ragnar Locker",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Ragnar Locker",
                        "Ragnar Locker",
                        "Ragnar Locker",
                        "Ragnar Locker"
                    ],
                    "entity_text": "Ragnar Locker"
                },
                "relation": "is",
                "object": {
                    "mention_id": 3,
                    "mention_text": "a ransomware group",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 5,
                    "mentions_merged": [
                        "a ransomware group",
                        "the name of the ransomware",
                        "a part of a ransomware family"
                    ],
                    "entity_text": "a ransomware group"
                }
            },
            {
                "subject": {
                    "mention_id": 4,
                    "mention_text": "Ragnar Locker",
                    "mention_class": "Malware",
                    "entity_id": 6,
                    "mentions_merged": [
                        "Ragnar Locker"
                    ],
                    "entity_text": "Ragnar Locker"
                },
                "relation": "is",
                "object": {
                    "mention_id": 5,
                    "mention_text": "the name of the ransomware",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 5,
                    "mentions_merged": [
                        "a ransomware group",
                        "the name of the ransomware",
                        "a part of a ransomware family"
                    ],
                    "entity_text": "a ransomware group"
                }
            },
            {
                "subject": {
                    "mention_id": 6,
                    "mention_text": "The gang",
                    "mention_class": "Attacker",
                    "entity_id": 2,
                    "mentions_merged": [
                        "The gang"
                    ],
                    "entity_text": "The gang"
                },
                "relation": "works as",
                "object": {
                    "mention_id": 7,
                    "mention_text": "a part of a ransomware family",
                    "mention_class": "This entity cannot be classified into any of the existing types",
                    "entity_id": 5,
                    "mentions_merged": [
                        "a ransomware group",
                        "the name of the ransomware",
                        "a part of a ransomware family"
                    ],
                    "entity_text": "a ransomware group"
                }
            },
            {
                "subject": {
                    "mention_id": 8,
                    "mention_text": "Ragnar Locker",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Ragnar Locker",
                        "Ragnar Locker",
                        "Ragnar Locker",
                        "Ragnar Locker"
                    ],
                    "entity_text": "Ragnar Locker"
                },
                "relation": "uses",
                "object": {
                    "mention_id": 9,
                    "mention_text": "the double extortion tactic",
                    "mention_class": "Malware Characteristic:Feature",
                    "entity_id": 7,
                    "mentions_merged": [
                        "the double extortion tactic"
                    ],
                    "entity_text": "the double extortion tactic"
                }
            },
            {
                "subject": {
                    "mention_id": 10,
                    "mention_text": "Threat actors",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "Threat actors",
                        "Threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor"
                    ],
                    "entity_text": "The threat actor"
                },
                "relation": "exfiltrating and triggering",
                "object": {
                    "mention_id": 11,
                    "mention_text": "encryption attack",
                    "mention_class": "Event",
                    "entity_id": 8,
                    "mentions_merged": [
                        "encryption attack"
                    ],
                    "entity_text": "encryption attack"
                }
            },
            {
                "subject": {
                    "mention_id": 12,
                    "mention_text": "Threat actor",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "Threat actors",
                        "Threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor"
                    ],
                    "entity_text": "The threat actor"
                },
                "relation": "changes",
                "object": {
                    "mention_id": 13,
                    "mention_text": "their obfuscation techniques",
                    "mention_class": "Malware Characteristic:Behavior",
                    "entity_id": 10,
                    "mentions_merged": [
                        "their obfuscation techniques"
                    ],
                    "entity_text": "their obfuscation techniques"
                }
            },
            {
                "subject": {
                    "mention_id": 14,
                    "mention_text": "Ragnar Locker",
                    "mention_class": "Attacker",
                    "entity_id": 0,
                    "mentions_merged": [
                        "Ragnar Locker",
                        "Ragnar Locker",
                        "Ragnar Locker",
                        "Ragnar Locker"
                    ],
                    "entity_text": "Ragnar Locker"
                },
                "relation": "initiates attacks by",
                "object": {
                    "mention_id": 15,
                    "mention_text": "compromising networks through RDP service",
                    "mention_class": "Exploit Target",
                    "entity_id": 11,
                    "mentions_merged": [
                        "compromising networks through RDP service"
                    ],
                    "entity_text": "compromising networks through RDP service"
                }
            },
            {
                "subject": {
                    "mention_id": 16,
                    "mention_text": "The threat actor",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "Threat actors",
                        "Threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor"
                    ],
                    "entity_text": "The threat actor"
                },
                "relation": "uses",
                "object": {
                    "mention_id": 17,
                    "mention_text": "brute force",
                    "mention_class": "Tool",
                    "entity_id": 13,
                    "mentions_merged": [
                        "brute force"
                    ],
                    "entity_text": "brute force"
                }
            },
            {
                "subject": {
                    "mention_id": 18,
                    "mention_text": "The threat actor",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "Threat actors",
                        "Threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor"
                    ],
                    "entity_text": "The threat actor"
                },
                "relation": "purchases",
                "object": {
                    "mention_id": 19,
                    "mention_text": "stolen credentials on the dark web",
                    "mention_class": "Credential",
                    "entity_id": 15,
                    "mentions_merged": [
                        "stolen credentials on the dark web"
                    ],
                    "entity_text": "stolen credentials on the dark web"
                }
            },
            {
                "subject": {
                    "mention_id": 20,
                    "mention_text": "The threat actor",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "Threat actors",
                        "Threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor"
                    ],
                    "entity_text": "The threat actor"
                },
                "relation": "elevates",
                "object": {
                    "mention_id": 21,
                    "mention_text": "their privileges",
                    "mention_class": "Malware Characteristic:Capability",
                    "entity_id": 16,
                    "mentions_merged": [
                        "their privileges"
                    ],
                    "entity_text": "their privileges"
                }
            },
            {
                "subject": {
                    "mention_id": 22,
                    "mention_text": "The threat actor",
                    "mention_class": "Attacker",
                    "entity_id": 1,
                    "mentions_merged": [
                        "Threat actors",
                        "Threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor",
                        "The threat actor"
                    ],
                    "entity_text": "The threat actor"
                },
                "relation": "exploits",
                "object": {
                    "mention_id": 23,
                    "mention_text": "CVE-2017-0213",
                    "mention_class": "Vulnerability",
                    "entity_id": 17,
                    "mentions_merged": [
                        "CVE-2017-0213",
                        "CVE-2017-0213",
                        "CVE-2017-0213"
                    ],
                    "entity_text": "CVE-2017-0213"
                }
            },
            {
                "subject": {
                    "mention_id": 24,
                    "mention_text": "CVE-2017-0213",
                    "mention_class": "Vulnerability",
                    "entity_id": 17,
                    "mentions_merged": [
                        "CVE-2017-0213",
                        "CVE-2017-0213",
                        "CVE-2017-0213"
                    ],
                    "entity_text": "CVE-2017-0213"
                },
                "relation": "is an elevation of privilege in",
                "object": {
                    "mention_id": 25,
                    "mention_text": "Windows COM Aggregate Marshaler",
                    "mention_class": "Exploit Target",
                    "entity_id": 12,
                    "mentions_merged": [
                        "Windows COM Aggregate Marshaler"
                    ],
                    "entity_text": "Windows COM Aggregate Marshaler"
                }
            },
            {
                "subject": {
                    "mention_id": 26,
                    "mention_text": "CVE-2017-0213",
                    "mention_class": "Vulnerability",
                    "entity_id": 17,
                    "mentions_merged": [
                        "CVE-2017-0213",
                        "CVE-2017-0213",
                        "CVE-2017-0213"
                    ],
                    "entity_text": "CVE-2017-0213"
                },
                "relation": "allows attackers to",
                "object": {
                    "mention_id": 27,
                    "mention_text": "run arbitrary code with elevated privileges",
                    "mention_class": "Event",
                    "entity_id": 9,
                    "mentions_merged": [
                        "run arbitrary code with elevated privileges"
                    ],
                    "entity_text": "run arbitrary code with elevated privileges"
                }
            },
            {
                "subject": {
                    "mention_id": 28,
                    "mention_text": "The attacker",
                    "mention_class": "Attacker",
                    "entity_id": 3,
                    "mentions_merged": [
                        "The attacker"
                    ],
                    "entity_text": "The attacker"
                },
                "relation": "runs",
                "object": {
                    "mention_id": 29,
                    "mention_text": "a specially crafted application",
                    "mention_class": "Tool",
                    "entity_id": 14,
                    "mentions_merged": [
                        "a specially crafted application"
                    ],
                    "entity_text": "a specially crafted application"
                }
            }
        ],
        "mentions_num": 30,
        "response_time": 6.899853944778442,
        "embedding_model": "text-embedding-3-large",
        "entity_num": 18,
        "threshold": 0.7,
        "Eval": {
            "TP": 16,
            "FP": 0,
            "FN": 1,
            "TN": 13
        }
    }
}