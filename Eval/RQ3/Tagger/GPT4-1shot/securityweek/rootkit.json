{
    "CTI": {
        "text": "The notorious North Korean threat group known as Lazarus exploited a Windows zero-day vulnerability for privilege escalation in attacks involving a rootkit named FudModule, according to cybersecurity firm Avast. The vulnerability is tracked as CVE-2024-21338 and it was observed by Avast in Lazarus attacks last year. The security company developed a proof-of-concept (PoC) exploit and sent it to Microsoft in August 2023. The flaw was patched by Microsoft with the company\u2019s February 2024 Patch Tuesday updates, but the initial advisory for CVE-2024-21338 did not list it as a zero-day. The vulnerability impacts the \u2018appid.sys\u2019 driver associated with Microsoft\u2019s AppLocker security feature. By targeting a vulnerability in a driver that is present on many systems \u2014 rather than using a bring your own vulnerable driver (BYOVD) approach \u2014 the attacker benefits from a higher degree of stealth. \u201cBy exploiting such a vulnerability, the attacker is in a sense living off the land with no need to bring, drop, or load any custom drivers, making it possible for a kernel attack to be truly fileless. This not only evades most detection mechanisms but also enables the attack on systems where driver allowlisting is in place,\u201d Avast explained. By exploiting CVE-2024-21338, Lazarus hackers were able to elevate their privileges on the compromised system and establish a kernel read/write primitive. This enabled them to perform direct kernel object manipulation in an updated version of the FudModule rootkit, which came to light in 2022. ",
        "link": "https://www.securityweek.com/windows-zero-day-exploited-by-north-korean-hackers-in-rootkit-attack/"
    },
    "IE": {
        "triplets": [
            {
                "subject": "North Korean threat group",
                "relation": "is known as",
                "object": "Lazarus"
            },
            {
                "subject": "Lazarus",
                "relation": "exploited",
                "object": "a Windows zero-day vulnerability"
            },
            {
                "subject": "a Windows zero-day vulnerability",
                "relation": "for",
                "object": "privilege escalation"
            },
            {
                "subject": "attacks",
                "relation": "involving",
                "object": "a rootkit named FudModule"
            },
            {
                "subject": "a Windows zero-day vulnerability",
                "relation": "is tracked as",
                "object": "CVE-2024-21338"
            },
            {
                "subject": "CVE-2024-21338",
                "relation": "was observed in",
                "object": "Lazarus attacks"
            },
            {
                "subject": "Avast",
                "relation": "developed",
                "object": "a proof-of-concept (PoC) exploit"
            },
            {
                "subject": "Avast",
                "relation": "sent",
                "object": "a proof-of-concept (PoC) exploit to Microsoft"
            },
            {
                "subject": "The flaw",
                "relation": "was patched by",
                "object": "Microsoft"
            },
            {
                "subject": "CVE-2024-21338",
                "relation": "impacts",
                "object": "the 'appid.sys' driver"
            },
            {
                "subject": "the 'appid.sys' driver",
                "relation": "is associated with",
                "object": "Microsoft\u2019s AppLocker security feature"
            },
            {
                "subject": "CVE-2024-21338",
                "relation": "enables",
                "object": "attack on systems with driver allowlisting"
            },
            {
                "subject": "Lazarus hackers",
                "relation": "were able to elevate",
                "object": "their privileges"
            },
            {
                "subject": "Lazarus hackers",
                "relation": "established",
                "object": "a kernel read/write primitive"
            },
            {
                "subject": "They",
                "relation": "perform",
                "object": "direct kernel object manipulation"
            },
            {
                "subject": "direct kernel object manipulation",
                "relation": "in",
                "object": "an updated version of the FudModule rootkit"
            }
        ],
        "triples_count": 16,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2205,
                "cost": 0.02205
            },
            "output": {
                "tokens": 458,
                "cost": 0.01374
            },
            "total": {
                "tokens": 2663,
                "cost": 0.03579
            }
        },
        "time": 15.375874280929565,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/securityweek/rootkit-QD1-mt9.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-apple.json",
                    0.1178916142244758
                ],
                [
                    "AVERTIUM-CVE-2023-36884.json",
                    0.1232676980741352
                ],
                [
                    "BleepingComputer-kasseika.json",
                    0.19422225711473676
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "North Korean threat group",
                    "class": "Attacker"
                },
                "relation": "is known as",
                "object": {
                    "text": "Lazarus",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "Lazarus",
                    "class": "Attacker"
                },
                "relation": "exploited",
                "object": {
                    "text": "a Windows zero-day vulnerability",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "a Windows zero-day vulnerability",
                    "class": "Vulnerability"
                },
                "relation": "for",
                "object": {
                    "text": "privilege escalation",
                    "class": "Malware Characteristic:Capability"
                }
            },
            {
                "subject": {
                    "text": "attacks",
                    "class": "Event"
                },
                "relation": "involving",
                "object": {
                    "text": "a rootkit named FudModule",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "a Windows zero-day vulnerability",
                    "class": "Vulnerability"
                },
                "relation": "is tracked as",
                "object": {
                    "text": "CVE-2024-21338",
                    "class": "Vulnerability"
                }
            },
            {
                "subject": {
                    "text": "CVE-2024-21338",
                    "class": "Vulnerability"
                },
                "relation": "was observed in",
                "object": {
                    "text": "Lazarus attacks",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Avast",
                    "class": "Organization"
                },
                "relation": "developed",
                "object": {
                    "text": "a proof-of-concept (PoC) exploit",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "Avast",
                    "class": "Organization"
                },
                "relation": "sent",
                "object": {
                    "text": "a proof-of-concept (PoC) exploit to Microsoft",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "The flaw",
                    "class": "Vulnerability"
                },
                "relation": "was patched by",
                "object": {
                    "text": "Microsoft",
                    "class": "Organization"
                }
            },
            {
                "subject": {
                    "text": "CVE-2024-21338",
                    "class": "Vulnerability"
                },
                "relation": "impacts",
                "object": {
                    "text": "the 'appid.sys' driver",
                    "class": "Exploit Target"
                }
            },
            {
                "subject": {
                    "text": "the 'appid.sys' driver",
                    "class": "Exploit Target"
                },
                "relation": "is associated with",
                "object": {
                    "text": "Microsoft\u2019s AppLocker security feature",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "CVE-2024-21338",
                    "class": "Vulnerability"
                },
                "relation": "enables",
                "object": {
                    "text": "attack on systems with driver allowlisting",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "Lazarus hackers",
                    "class": "Attacker"
                },
                "relation": "were able to elevate",
                "object": {
                    "text": "their privileges",
                    "class": "Malware Characteristic:Capability"
                }
            },
            {
                "subject": {
                    "text": "Lazarus hackers",
                    "class": "Attacker"
                },
                "relation": "established",
                "object": {
                    "text": "a kernel read/write primitive",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "They",
                    "class": "Attacker"
                },
                "relation": "perform",
                "object": {
                    "text": "direct kernel object manipulation",
                    "class": "Malware Characteristic:Behavior"
                }
            },
            {
                "subject": {
                    "text": "direct kernel object manipulation",
                    "class": "Malware Characteristic:Behavior"
                },
                "relation": "in",
                "object": {
                    "text": "an updated version of the FudModule rootkit",
                    "class": "Malware"
                }
            }
        ],
        "response_time": 44.70547294616699,
        "Demo_num": 1,
        "tag_prompt": "/home/yutong/CTINexus/Eval/RQ3/Tagger/GPT4-1shot/prompt_store/securityweek/rootkit.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1046,
                "cost": 0.01046
            },
            "output": {
                "tokens": 892,
                "cost": 0.02676
            },
            "total": {
                "tokens": 1938,
                "cost": 0.03722
            }
        },
        "Eval": {
            "correct": 27,
            "incorrect": 5,
            "TP": 27,
            "TN": 1,
            "FP": 5,
            "FN": 0,
            "Macro-counters": {
                "Account": {
                    "TP": 0,
                    "TN": 32,
                    "FP": 0,
                    "FN": 0
                },
                "Credential": {
                    "TP": 0,
                    "TN": 32,
                    "FP": 0,
                    "FN": 0
                },
                "Tool": {
                    "TP": 1,
                    "TN": 30,
                    "FP": 1,
                    "FN": 0
                },
                "Attacker": {
                    "TP": 5,
                    "TN": 26,
                    "FP": 1,
                    "FN": 0
                },
                "Event": {
                    "TP": 2,
                    "TN": 29,
                    "FP": 1,
                    "FN": 0
                },
                "Exploit Target": {
                    "TP": 0,
                    "TN": 30,
                    "FP": 2,
                    "FN": 0
                },
                "Indicator": {
                    "TP": 0,
                    "TN": 32,
                    "FP": 0,
                    "FN": 0
                },
                "Information": {
                    "TP": 2,
                    "TN": 30,
                    "FP": 0,
                    "FN": 0
                },
                "Location": {
                    "TP": 0,
                    "TN": 32,
                    "FP": 0,
                    "FN": 0
                },
                "Malware": {
                    "TP": 2,
                    "TN": 30,
                    "FP": 0,
                    "FN": 0
                },
                "Malware Characteristic": {
                    "TP": 4,
                    "TN": 26,
                    "FP": 0,
                    "FN": 2
                },
                "Organization": {
                    "TP": 3,
                    "TN": 29,
                    "FP": 0,
                    "FN": 0
                },
                "Infrastructure": {
                    "TP": 0,
                    "TN": 30,
                    "FP": 0,
                    "FN": 2
                },
                "Time": {
                    "TP": 0,
                    "TN": 32,
                    "FP": 0,
                    "FN": 0
                },
                "Vulnerability": {
                    "TP": 8,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "This entity cannot be classified into any of the existing types": {
                    "TP": 0,
                    "TN": 31,
                    "FP": 0,
                    "FN": 1
                }
            },
            "Num_of_classes": 9
        }
    }
}