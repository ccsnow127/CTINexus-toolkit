{
    "CTI": {
        "text": "As part of TAG's mission to counter serious threats to Google and our users, we've analyzed a range of persistent threats including APT35 and Charming Kitten, an Iranian government-backed group that regularly targets high risk users. For years, we have been countering this group\u2019s efforts to hijack accounts, deploy malware, and their use of novel techniques to conduct espionage aligned with the interests of the Iranian government. Now, we\u2019re shining light on a new tool of theirs. In December 2021, TAG discovered a novel Charming Kitten tool, named HYPERSCRAPE, used to steal user data from Gmail, Yahoo!, and Microsoft Outlook accounts. The attacker runs HYPERSCRAPE on their own machine to download victims\u2019 inboxes using previously acquired credentials. We have seen it deployed against fewer than two dozen accounts located in Iran. The oldest known sample is from 2020, and the tool is still under active development. We have taken actions to re-secure these accounts and have notified the victims through our Government Backed Attacker Warnings.",
        "link": "https://blog.google/threat-analysis-group/new-iranian-apt-data-extraction-tool/"
    },
    "IE": {
        "triplets": [
            {
                "subject": "APT35",
                "relation": "is known as",
                "object": "Charming Kitten"
            },
            {
                "subject": "Charming Kitten",
                "relation": "backed by",
                "object": "Iranian government"
            },
            {
                "subject": "Charming Kitten",
                "relation": "targets",
                "object": "high risk users"
            },
            {
                "subject": "Charming Kitten",
                "relation": "deploys",
                "object": "malware"
            },
            {
                "subject": "Charming Kitten",
                "relation": "uses",
                "object": "novel techniques"
            },
            {
                "subject": "Charming Kitten",
                "relation": "conducts",
                "object": "espionage"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "is a tool of",
                "object": "Charming Kitten"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "used to steal",
                "object": "user data"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "targets",
                "object": "Gmail accounts"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "targets",
                "object": "Yahoo! accounts"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "targets",
                "object": "Microsoft Outlook accounts"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "runs on",
                "object": "attacker's machine"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "downloads",
                "object": "victims' inboxes"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "uses",
                "object": "previously acquired credentials"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "deployed against",
                "object": "accounts located in Iran"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "sample from",
                "object": "2020"
            },
            {
                "subject": "HYPERSCRAPE",
                "relation": "is under",
                "object": "active development"
            }
        ],
        "triples_count": 17,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2545,
                "cost": 0.02545
            },
            "output": {
                "tokens": 427,
                "cost": 0.01281
            },
            "total": {
                "tokens": 2972,
                "cost": 0.03826
            }
        },
        "time": 12.506486177444458,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/Google_TAG/iranian-QD1-e4t.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-microsoft.json",
                    0.08266549136399079
                ],
                [
                    "AVERTIUM-muddywater.json",
                    0.16527692397284058
                ],
                [
                    "AVERTIUM-charming-kitten.json",
                    0.1963478811595999
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "APT35",
                    "class": "Attacker"
                },
                "relation": "is known as",
                "object": {
                    "text": "Charming Kitten",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "Charming Kitten",
                    "class": "Attacker"
                },
                "relation": "backed by",
                "object": {
                    "text": "Iranian government",
                    "class": "Organization"
                }
            },
            {
                "subject": {
                    "text": "Charming Kitten",
                    "class": "Attacker"
                },
                "relation": "targets",
                "object": {
                    "text": "high risk users",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "Charming Kitten",
                    "class": "Attacker"
                },
                "relation": "deploys",
                "object": {
                    "text": "malware",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "Charming Kitten",
                    "class": "Attacker"
                },
                "relation": "uses",
                "object": {
                    "text": "novel techniques",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "Charming Kitten",
                    "class": "Attacker"
                },
                "relation": "conducts",
                "object": {
                    "text": "espionage",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "is a tool of",
                "object": {
                    "text": "Charming Kitten",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "used to steal",
                "object": {
                    "text": "user data",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "targets",
                "object": {
                    "text": "Gmail accounts",
                    "class": "Account"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "targets",
                "object": {
                    "text": "Yahoo! accounts",
                    "class": "Account"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "targets",
                "object": {
                    "text": "Microsoft Outlook accounts",
                    "class": "Account"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "runs on",
                "object": {
                    "text": "attacker's machine",
                    "class": "Infrastructure"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "downloads",
                "object": {
                    "text": "victims' inboxes",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "uses",
                "object": {
                    "text": "previously acquired credentials",
                    "class": "Credential"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "deployed against",
                "object": {
                    "text": "accounts located in Iran",
                    "class": "Location"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "sample from",
                "object": {
                    "text": "2020",
                    "class": "Time"
                }
            },
            {
                "subject": {
                    "text": "HYPERSCRAPE",
                    "class": "Tool"
                },
                "relation": "is under",
                "object": {
                    "text": "active development",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            }
        ],
        "response_time": 37.297054052352905,
        "Demo_num": 1,
        "tag_prompt": "/home/yutong/CTINexus/Eval/RQ3/Tagger/GPT4-1shot/prompt_store/Google_TAG/iranian.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1052,
                "cost": 0.010520000000000002
            },
            "output": {
                "tokens": 772,
                "cost": 0.02316
            },
            "total": {
                "tokens": 1824,
                "cost": 0.03368
            }
        },
        "Eval": {
            "correct": 33,
            "incorrect": 1,
            "TP": 30,
            "TN": 4,
            "FP": 1,
            "FN": 0,
            "Macro-counters": {
                "Account": {
                    "TP": 3,
                    "TN": 31,
                    "FP": 0,
                    "FN": 0
                },
                "Credential": {
                    "TP": 1,
                    "TN": 33,
                    "FP": 0,
                    "FN": 0
                },
                "Tool": {
                    "TP": 11,
                    "TN": 23,
                    "FP": 0,
                    "FN": 0
                },
                "Attacker": {
                    "TP": 8,
                    "TN": 26,
                    "FP": 0,
                    "FN": 0
                },
                "Event": {
                    "TP": 1,
                    "TN": 33,
                    "FP": 0,
                    "FN": 0
                },
                "Exploit Target": {
                    "TP": 0,
                    "TN": 34,
                    "FP": 0,
                    "FN": 0
                },
                "Indicator": {
                    "TP": 0,
                    "TN": 34,
                    "FP": 0,
                    "FN": 0
                },
                "Information": {
                    "TP": 2,
                    "TN": 32,
                    "FP": 0,
                    "FN": 0
                },
                "Location": {
                    "TP": 1,
                    "TN": 33,
                    "FP": 0,
                    "FN": 0
                },
                "Malware": {
                    "TP": 1,
                    "TN": 33,
                    "FP": 0,
                    "FN": 0
                },
                "Malware Characteristic": {
                    "TP": 0,
                    "TN": 34,
                    "FP": 0,
                    "FN": 0
                },
                "Organization": {
                    "TP": 1,
                    "TN": 33,
                    "FP": 0,
                    "FN": 0
                },
                "Infrastructure": {
                    "TP": 0,
                    "TN": 33,
                    "FP": 1,
                    "FN": 0
                },
                "Time": {
                    "TP": 1,
                    "TN": 33,
                    "FP": 0,
                    "FN": 0
                },
                "Vulnerability": {
                    "TP": 0,
                    "TN": 34,
                    "FP": 0,
                    "FN": 0
                },
                "This entity cannot be classified into any of the existing types": {
                    "TP": 3,
                    "TN": 30,
                    "FP": 0,
                    "FN": 1
                }
            },
            "Num_of_classes": 12
        }
    }
}