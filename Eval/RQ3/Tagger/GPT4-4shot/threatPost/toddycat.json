{
    "CTI": {
        "text": "An advanced persistent threat (APT) group, dubbed ToddyCat, is believed behind a series of attacks targeting Microsoft Exchange servers of high-profile government and military installations in Asia and Europe. The campaigns, according to researchers, began in December 2020, and have been largely poorly understood in their complexity until now. The first wave of attacks exclusively targeted Microsoft Exchange Servers, which were compromised with Samurai, a sophisticated passive backdoor that usually works on ports 80 and 443. The APT leverages two passive backdoors within the Exchange Server environment with malware called Samurai and Ninja, which researchers say are used by the adversaries to take complete control of the victim\u2019s hardware and network.",
        "link": "https://threatpost.com/elusive-toddycat-apt-targets-microsoft-exchange-servers/180031/"
    },
    "IE": {
        "triplets": [
            {
                "subject": "ToddyCat",
                "relation": "is",
                "object": "an advanced persistent threat (APT) group"
            },
            {
                "subject": "ToddyCat",
                "relation": "is believed behind",
                "object": "a series of attacks targeting Microsoft Exchange servers"
            },
            {
                "subject": "the series of attacks",
                "relation": "target",
                "object": "high-profile government and military installations"
            },
            {
                "subject": "the series of attacks",
                "relation": "locate in",
                "object": "Asia"
            },
            {
                "subject": "the series of attacks",
                "relation": "locate in",
                "object": "Europe"
            },
            {
                "subject": "The first wave of attacks",
                "relation": "targeted",
                "object": "Microsoft Exchange Servers"
            },
            {
                "subject": "Microsoft Exchange Servers",
                "relation": "were compromised with",
                "object": "Samurai"
            },
            {
                "subject": "Samurai",
                "relation": "is",
                "object": "a sophisticated passive backdoor"
            },
            {
                "subject": "Samurai",
                "relation": "works on",
                "object": "ports 80 and 443"
            },
            {
                "subject": "The APT",
                "relation": "leverages",
                "object": "two passive backdoors within the Exchange Server environment"
            },
            {
                "subject": "The APT",
                "relation": "leverages",
                "object": "malware called Samurai and Ninja"
            },
            {
                "subject": "Samurai and Ninja",
                "relation": "are used by",
                "object": "the adversaries to take complete control of the victim\u2019s hardware and network"
            }
        ],
        "triples_count": 12,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 2916,
                "cost": 0.029160000000000002
            },
            "output": {
                "tokens": 322,
                "cost": 0.00966
            },
            "total": {
                "tokens": 3238,
                "cost": 0.03882
            }
        },
        "time": 8.040677070617676,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/threatPost/toddycat-QD1-6lj.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "AVERTIUM-fancy-bear.json",
                    0.08853766998640972
                ],
                [
                    "AVERTIUM-fargo.json",
                    0.08978315842183757
                ],
                [
                    "AVERTIUM-charming-kitten.json",
                    0.1981265573263016
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "ToddyCat",
                    "class": "Attacker"
                },
                "relation": "is",
                "object": {
                    "text": "an advanced persistent threat (APT) group",
                    "class": "This entity cannot be classified into any of the existing types"
                }
            },
            {
                "subject": {
                    "text": "ToddyCat",
                    "class": "Attacker"
                },
                "relation": "is believed behind",
                "object": {
                    "text": "a series of attacks targeting Microsoft Exchange servers",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "the series of attacks",
                    "class": "Event"
                },
                "relation": "target",
                "object": {
                    "text": "high-profile government and military installations",
                    "class": "Exploit Target"
                }
            },
            {
                "subject": {
                    "text": "the series of attacks",
                    "class": "Event"
                },
                "relation": "locate in",
                "object": {
                    "text": "Asia",
                    "class": "Location"
                }
            },
            {
                "subject": {
                    "text": "the series of attacks",
                    "class": "Event"
                },
                "relation": "locate in",
                "object": {
                    "text": "Europe",
                    "class": "Location"
                }
            },
            {
                "subject": {
                    "text": "The first wave of attacks",
                    "class": "Event"
                },
                "relation": "targeted",
                "object": {
                    "text": "Microsoft Exchange Servers",
                    "class": "Exploit Target"
                }
            },
            {
                "subject": {
                    "text": "Microsoft Exchange Servers",
                    "class": "Exploit Target"
                },
                "relation": "were compromised with",
                "object": {
                    "text": "Samurai",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "Samurai",
                    "class": "Malware"
                },
                "relation": "is",
                "object": {
                    "text": "a sophisticated passive backdoor",
                    "class": "Malware Characteristic:Feature"
                }
            },
            {
                "subject": {
                    "text": "Samurai",
                    "class": "Malware"
                },
                "relation": "works on",
                "object": {
                    "text": "ports 80 and 443",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "The APT",
                    "class": "Attacker"
                },
                "relation": "leverages",
                "object": {
                    "text": "two passive backdoors within the Exchange Server environment",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "The APT",
                    "class": "Attacker"
                },
                "relation": "leverages",
                "object": {
                    "text": "malware called Samurai and Ninja",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "Samurai and Ninja",
                    "class": "Malware"
                },
                "relation": "are used by",
                "object": {
                    "text": "the adversaries to take complete control of the victim\u2019s hardware and network",
                    "class": "Event"
                }
            }
        ],
        "response_time": 26.051834106445312,
        "Demo_num": 4,
        "tag_prompt": "/home/yutong/CTINexus/Eval/RQ3/Tagger/GPT4-4shot/prompt_store/threatPost/toddycat.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1115,
                "cost": 0.01115
            },
            "output": {
                "tokens": 571,
                "cost": 0.01713
            },
            "total": {
                "tokens": 1686,
                "cost": 0.02828
            }
        },
        "Eval": {
            "correct": 21,
            "incorrect": 3,
            "TP": 20,
            "TN": 4,
            "FP": 3,
            "FN": 0,
            "Macro-counters": {
                "Account": {
                    "TP": 0,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "Credential": {
                    "TP": 0,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "Tool": {
                    "TP": 0,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "Attacker": {
                    "TP": 4,
                    "TN": 20,
                    "FP": 0,
                    "FN": 0
                },
                "Event": {
                    "TP": 5,
                    "TN": 18,
                    "FP": 1,
                    "FN": 0
                },
                "Exploit Target": {
                    "TP": 2,
                    "TN": 21,
                    "FP": 1,
                    "FN": 0
                },
                "Indicator": {
                    "TP": 0,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "Information": {
                    "TP": 0,
                    "TN": 23,
                    "FP": 1,
                    "FN": 0
                },
                "Location": {
                    "TP": 2,
                    "TN": 22,
                    "FP": 0,
                    "FN": 0
                },
                "Malware": {
                    "TP": 6,
                    "TN": 18,
                    "FP": 0,
                    "FN": 0
                },
                "Malware Characteristic": {
                    "TP": 1,
                    "TN": 23,
                    "FP": 0,
                    "FN": 0
                },
                "Organization": {
                    "TP": 0,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "Infrastructure": {
                    "TP": 0,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "Time": {
                    "TP": 0,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "Vulnerability": {
                    "TP": 0,
                    "TN": 24,
                    "FP": 0,
                    "FN": 0
                },
                "This entity cannot be classified into any of the existing types": {
                    "TP": 1,
                    "TN": 20,
                    "FP": 0,
                    "FN": 3
                }
            },
            "Num_of_classes": 8
        }
    }
}