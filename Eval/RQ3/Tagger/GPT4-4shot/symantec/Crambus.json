{
    "CTI": {
        "text": "The Iranian Crambus espionage group (aka OilRig, APT34) staged an eight-month-long intrusion against a government in the Middle East between February and September 2023. During the compromise, the attackers stole files and passwords and, in one case, installed a PowerShell backdoor (dubbed PowerExchange) that was used to monitor incoming mails sent from an Exchange Server in order to execute commands sent by the attackers in the form of emails, and surreptitiously forwarded results  to the attackers. Malicious activity occurred on at least 12 computers and there is evidence that the attackers deployed backdoors and keyloggers on dozens more. In addition to deploying malware, the attackers made frequent use of the publicly available network administration tool Plink to configure port-forwarding rules on compromised machines, enabling remote access via the Remote Desktop Protocol (RDP). There is also evidence the attackers modified Windows firewall rules in order to enable remote access.",
        "link": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/crambus-middle-east-government"
    },
    "IE": {
        "triplets": [
            {
                "subject": "The Iranian Crambus espionage group",
                "relation": "is known as",
                "object": "OilRig"
            },
            {
                "subject": "The Iranian Crambus espionage group",
                "relation": "is known as",
                "object": "APT34"
            },
            {
                "subject": "The Iranian Crambus espionage group",
                "relation": "staged",
                "object": "an eight-month-long intrusion"
            },
            {
                "subject": "The intrusion",
                "relation": "targeted",
                "object": "a government in the Middle East"
            },
            {
                "subject": "attackers",
                "relation": "stole",
                "object": "files"
            },
            {
                "subject": "attackers",
                "relation": "stole",
                "object": "passwords"
            },
            {
                "subject": "attackers",
                "relation": "installed",
                "object": "a PowerShell backdoor"
            },
            {
                "subject": "The PowerShell backdoor",
                "relation": "is dubbed",
                "object": "PowerExchange"
            },
            {
                "subject": "PowerExchange",
                "relation": "was used to monitor",
                "object": "incoming mails"
            },
            {
                "subject": "PowerExchange",
                "relation": "executed",
                "object": "commands sent by the attackers"
            },
            {
                "subject": "PowerExchange",
                "relation": "forwarded",
                "object": "results to the attackers"
            },
            {
                "subject": "Malicious activity",
                "relation": "occurred on",
                "object": "at least 12 computers"
            },
            {
                "subject": "attackers",
                "relation": "deployed",
                "object": "backdoors"
            },
            {
                "subject": "attackers",
                "relation": "deployed",
                "object": "keyloggers"
            },
            {
                "subject": "The attackers",
                "relation": "made use of",
                "object": "Plink"
            },
            {
                "subject": "Plink",
                "relation": "to configure",
                "object": "port-forwarding rules"
            },
            {
                "subject": "port-forwarding rules",
                "relation": "enable",
                "object": "remote access via RDP"
            },
            {
                "subject": "attackers",
                "relation": "modified",
                "object": "Windows firewall rules"
            },
            {
                "subject": "Windows firewall rules",
                "relation": "enable",
                "object": "remote access"
            }
        ],
        "triples_count": 19,
        "cost": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1942,
                "cost": 0.019420000000000003
            },
            "output": {
                "tokens": 454,
                "cost": 0.01362
            },
            "total": {
                "tokens": 2396,
                "cost": 0.03304
            }
        },
        "time": 11.69729232788086,
        "Prompt": {
            "constructed_prompt": "/home/yutong/CTINexus/dataset/RE-IE-outputs-3-asc/prompt_store/symantec/Crambus-QD1-xeR.jinja",
            "prompt_template": "QD1.jinja",
            "demo_retriever": "kNN",
            "demo_number": 3,
            "demos": [
                [
                    "BleepingComputer-github.json",
                    0.10149218992930456
                ],
                [
                    "BleepingComputer-mastodon.json",
                    0.10563173340217791
                ],
                [
                    "AVERTIUM-charming-kitten.json",
                    0.12206996804023774
                ]
            ],
            "permutation": "asc"
        }
    },
    "ET": {
        "typed_triplets": [
            {
                "subject": {
                    "text": "The Iranian Crambus espionage group",
                    "class": "Attacker"
                },
                "relation": "is known as",
                "object": {
                    "text": "OilRig",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "The Iranian Crambus espionage group",
                    "class": "Attacker"
                },
                "relation": "is known as",
                "object": {
                    "text": "APT34",
                    "class": "Attacker"
                }
            },
            {
                "subject": {
                    "text": "The Iranian Crambus espionage group",
                    "class": "Attacker"
                },
                "relation": "staged",
                "object": {
                    "text": "an eight-month-long intrusion",
                    "class": "Event"
                }
            },
            {
                "subject": {
                    "text": "The intrusion",
                    "class": "Event"
                },
                "relation": "targeted",
                "object": {
                    "text": "a government in the Middle East",
                    "class": "Organization"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "stole",
                "object": {
                    "text": "files",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "stole",
                "object": {
                    "text": "passwords",
                    "class": "Credential"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "installed",
                "object": {
                    "text": "a PowerShell backdoor",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "The PowerShell backdoor",
                    "class": "Malware"
                },
                "relation": "is dubbed",
                "object": {
                    "text": "PowerExchange",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "PowerExchange",
                    "class": "Malware"
                },
                "relation": "was used to monitor",
                "object": {
                    "text": "incoming mails",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "PowerExchange",
                    "class": "Malware"
                },
                "relation": "executed",
                "object": {
                    "text": "commands sent by the attackers",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "PowerExchange",
                    "class": "Malware"
                },
                "relation": "forwarded",
                "object": {
                    "text": "results to the attackers",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Malicious activity",
                    "class": "Event"
                },
                "relation": "occurred on",
                "object": {
                    "text": "at least 12 computers",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "deployed",
                "object": {
                    "text": "backdoors",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "deployed",
                "object": {
                    "text": "keyloggers",
                    "class": "Malware"
                }
            },
            {
                "subject": {
                    "text": "The attackers",
                    "class": "Attacker"
                },
                "relation": "made use of",
                "object": {
                    "text": "Plink",
                    "class": "Tool"
                }
            },
            {
                "subject": {
                    "text": "Plink",
                    "class": "Tool"
                },
                "relation": "to configure",
                "object": {
                    "text": "port-forwarding rules",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "port-forwarding rules",
                    "class": "Information"
                },
                "relation": "enable",
                "object": {
                    "text": "remote access via RDP",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "attackers",
                    "class": "Attacker"
                },
                "relation": "modified",
                "object": {
                    "text": "Windows firewall rules",
                    "class": "Information"
                }
            },
            {
                "subject": {
                    "text": "Windows firewall rules",
                    "class": "Information"
                },
                "relation": "enable",
                "object": {
                    "text": "remote access",
                    "class": "Information"
                }
            }
        ],
        "response_time": 48.78683376312256,
        "Demo_num": 4,
        "tag_prompt": "/home/yutong/CTINexus/Eval/RQ3/Tagger/GPT4-4shot/prompt_store/symantec/Crambus.txt",
        "model_usage": {
            "model": "gpt-4-0125-preview",
            "input": {
                "tokens": 1380,
                "cost": 0.013800000000000002
            },
            "output": {
                "tokens": 1143,
                "cost": 0.03429
            },
            "total": {
                "tokens": 2523,
                "cost": 0.04809
            }
        },
        "Eval": {
            "correct": 38,
            "incorrect": 0,
            "TP": 38,
            "TN": 0,
            "FP": 0,
            "FN": 0,
            "Macro-counters": {
                "Account": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                },
                "Credential": {
                    "TP": 1,
                    "TN": 37,
                    "FP": 0,
                    "FN": 0
                },
                "Tool": {
                    "TP": 2,
                    "TN": 36,
                    "FP": 0,
                    "FN": 0
                },
                "Attacker": {
                    "TP": 12,
                    "TN": 26,
                    "FP": 0,
                    "FN": 0
                },
                "Event": {
                    "TP": 3,
                    "TN": 35,
                    "FP": 0,
                    "FN": 0
                },
                "Exploit Target": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                },
                "Indicator": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                },
                "Information": {
                    "TP": 11,
                    "TN": 27,
                    "FP": 0,
                    "FN": 0
                },
                "Location": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                },
                "Malware": {
                    "TP": 8,
                    "TN": 30,
                    "FP": 0,
                    "FN": 0
                },
                "Malware Characteristic": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                },
                "Organization": {
                    "TP": 1,
                    "TN": 37,
                    "FP": 0,
                    "FN": 0
                },
                "Infrastructure": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                },
                "Time": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                },
                "Vulnerability": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                },
                "This entity cannot be classified into any of the existing types": {
                    "TP": 0,
                    "TN": 38,
                    "FP": 0,
                    "FN": 0
                }
            },
            "Num_of_classes": 7
        }
    }
}